diff -ruN openssh-2.9p1-orig/Makefile.in openssh-2.9p1/Makefile.in
--- openssh-2.9p1-orig/Makefile.in	Fri Apr 27 10:31:08 2001
+++ openssh-2.9p1/Makefile.in	Sun Apr 29 21:59:59 2001
@@ -49,7 +49,7 @@
 
 SSHOBJS= ssh.o sshconnect.o sshconnect1.o sshconnect2.o sshtty.o readconf.o clientloop.o
 
-SSHDOBJS= sshd.o auth.o auth1.o auth2.o auth-chall.o auth2-chall.o auth-rhosts.o auth-options.o auth-krb4.o auth-pam.o auth2-pam.o auth-passwd.o auth-rsa.o auth-rh-rsa.o auth-sia.o sshpty.o sshlogin.o loginrec.o servconf.o serverloop.o md5crypt.o session.o groupaccess.o
+SSHDOBJS= sshd.o auth.o auth1.o auth2.o auth-chall.o auth2-chall.o auth-rhosts.o auth-options.o auth-krb4.o auth-pam.o auth2-pam.o auth-passwd.o auth-rsa.o auth-rh-rsa.o auth-securid.o auth-sia.o sshpty.o sshlogin.o loginrec.o servconf.o serverloop.o md5crypt.o session.o groupaccess.o
 
 MANPAGES	= scp.1.out ssh-add.1.out ssh-agent.1.out ssh-keygen.1.out ssh-keyscan.1.out ssh.1.out sshd.8.out sftp-server.8.out sftp.1.out
 MANPAGES_IN	= scp.1 ssh-add.1 ssh-agent.1 ssh-keygen.1 ssh-keyscan.1 ssh.1 sshd.8 sftp-server.8 sftp.1
diff -ruN openssh-2.9p1-orig/README.SecurID openssh-2.9p1/README.SecurID
--- openssh-2.9p1-orig/README.SecurID	Thu Jan  1 10:00:00 1970
+++ openssh-2.9p1/README.SecurID	Sun Apr 29 21:59:59 2001
@@ -0,0 +1,90 @@
+/*
+ * Author: Theo Schlossnagle <jesus@omniti.com>
+ * Copyright (c) 2000,2001 Theo Schlossnagle <jesus@omniti.com>
+ *                    All rights reserved
+ * Created: September 21, 2000
+ * License: OpenSSH License.  See the license for OpenSSH for more details.
+ *
+ * April 24, 2001:
+ * Updated to 2.9.0p1 -- jesus@omniti.com
+ * added autoconf clauses to fault if sdiclient.a and headers aren't there.
+ *
+ * April 21, 2001:
+ * Updated to 2.5.2p2 -- jesus@omniti.com
+ * Incorporated some bug fixes from Anders Olsen to fix next-token code.
+ *
+ * March 19, 2001:
+ * Updated to 2.5.2p1 -- jesus@omniti.com
+ *
+ * December 20, 2000:
+ * Updated to 2.3.0p1 -- jesus@omniti.com
+ *
+ * Jan 9th, 2001:
+ * Added SecurIDUsersFile, SecurIDIgnoreShell, AllowNonSecurID directives
+ * to the sshd_config file.  These parameters are documented in the man page.
+ * This provides a more logical seperationg between fail-through due to system
+ * failure and fall-through by configuration. (fall-through vs. fail-through)
+ *   -- jesus@omniti.com
+ */
+
+Seems like a few people are interested.  So here is the patch.
+
+This has only been tested on UNICIES that support PAM.  There is untested
+(only 5 lines) code in auth-passwd.c that should provide the same
+functionality for normal (non-PAM) password verifications.
+
+The patch is logical quite small, the physical patch bulky because it contains
+all the line number changes in "configure" after running autoconf on the
+modified configure.in file (in which I changed maybe 10 lines -- Yuk.)
+
+The sshd man page has been patched too :-)  Read it for the two new options
+relating to SecurID.
+
+How it works:
+
+0) apply patch ;-)
+1) copy sdi headers (in SecurID example directory) into either a standard
+include place (like /usr/local/include) or into the openssh source tree
+or add the --with-cflags=-I/path/to/ace/examples (where the include files are)
+2) copy the sdiclient.a file (same dir) into the openssh source tree.
+
+Make sure that /var/ace contains your sdconf.rec, etc.  If you installed
+SecurID client or server on a machine it should be this way already.  If you
+used a non-standard install location do a "ln -s /path/to/ace/data /var/ace"
+
+3) add --with-securid --with-pam to the configure flags.  This module rides on
+the PAM authentication mechanism.
+
+It will trigger if a user has a shell in /etc/passwd that ends with "sdshell"
+and it snags your shell the same way sdshell does.  Users with other shells
+will log in as if SecurID didn't exist.
+
+Done:
+  o Normal passcode verification
+  o Enter next token for verification
+    (use ssh -v to see the *useful* debgging messages)
+
+ssh -v will let you know if:
+ o your code was accepted.
+ o your code was rejected.
+ o you are required to wait for the next token and enter that.
+
+TODO:
+  o Handle PIN creation and changing (as their are by default three log in
+attempts, it should be straight forward to integrate in these additions --
+both of these operations require exactly three user inputs.)
+  o Add sshd_config parameter to specify the VAR_ACE location (forced to
+/var/ace OR VAR_ACE environment variable now.)
+  o Make autoconf find the headers in logical places and add a long-option to
+give it a hint.  I am an "autoconf idiot"... The small changes I made were
+challenging enough :) 
+
+
+DISCLAIMER:
+  I works for me (yes, in production).  If you get locked out of a production
+system becuase you replaced your sshd with this one, feeling really dumb is
+YOUR responsibility NOT mine.  It is not my fault :-D
+
+Hope this is useful! scp (and all other tools that can use ssh like rsync and
+cvs) will work now!!!! Hooray!
+
diff -ruN openssh-2.9p1-orig/acconfig.h openssh-2.9p1/acconfig.h
--- openssh-2.9p1-orig/acconfig.h	Fri Apr  6 03:15:08 2001
+++ openssh-2.9p1/acconfig.h	Sun Apr 29 21:59:59 2001
@@ -187,6 +187,9 @@
 /* Define if you want S/Key support */
 #undef SKEY
 
+/* Define if you want SecurID support */
+#undef SECURID
+
 /* Define if you want TCP Wrappers support */
 #undef LIBWRAP
 
diff -ruN openssh-2.9p1-orig/auth-pam.c openssh-2.9p1/auth-pam.c
--- openssh-2.9p1-orig/auth-pam.c	Tue Apr 24 04:38:37 2001
+++ openssh-2.9p1/auth-pam.c	Sun Apr 29 21:59:59 2001
@@ -170,7 +170,6 @@
 
 	return PAM_SUCCESS;
 }
-
 /* Called at exit to cleanly shutdown PAM */
 void do_pam_cleanup_proc(void *context)
 {
@@ -213,7 +212,19 @@
 		return 0;
 	if (*password == '\0' && options.permit_empty_passwd == 0)
 		return 0;
-
+#ifdef SECURID
+	if (options.securid_authentication == 1) {
+		int ret;
+		debug("Attempting SecurID authentication user \"%.100s\"", pw->pw_name);
+		ret = auth_securid_password(pw, password);
+		if (ret >= 0)
+			return ret;
+		/* Only returns < 0 if the account is not a SecurID account */
+		/* Fall back to ordinary passwd authentication. */
+	} else {
+		debug("SecurID disabled in server config.  Using PAM.");
+	}
+#endif
 	__pampasswd = password;
 
 	pamstate = INITIAL_LOGIN;
diff -ruN openssh-2.9p1-orig/auth-passwd.c openssh-2.9p1/auth-passwd.c
--- openssh-2.9p1-orig/auth-passwd.c	Wed Apr 25 22:50:19 2001
+++ openssh-2.9p1/auth-passwd.c	Sun Apr 29 21:59:59 2001
@@ -147,6 +147,15 @@
 	}
 #endif
 
+#ifdef SECURID
+	if (options.securid_authentication == 1) {
+		int ret = auth_securid_password(pw, password);
+		if (ret >= 0)
+			return ret;
+		/* Only returns < 0 if the account is not a SecurID account */
+		/* Fall back to ordinary passwd authentication. */
+	}
+#endif
 #ifdef WITH_AIXAUTHENTICATE
 	return (authenticate(pw->pw_name,password,&reenter,&authmsg) == 0);
 #endif
diff -ruN openssh-2.9p1-orig/auth-securid.c openssh-2.9p1/auth-securid.c
--- openssh-2.9p1-orig/auth-securid.c	Thu Jan  1 10:00:00 1970
+++ openssh-2.9p1/auth-securid.c	Sun Apr 29 21:59:59 2001
@@ -0,0 +1,189 @@
+/*
+ * Author: Theo Schlossnagle <jesus@omniti.com>
+ * Copyright (c) 2000 Theo Schlossnagle <jesus@omniti.com>
+ *                    All rights reserved
+ * Created: September 21, 2000
+ * This file contains the code to process a SecurID authentication
+ * including the "next token" request.
+ */
+
+#include "includes.h"
+
+RCSID("$OpenBSD: auth-securid.c,v 1.0 2000/09/21 01:39:38 jesus Exp $");
+
+#include "packet.h"
+#include "ssh.h"
+#include "log.h"
+#include "servconf.h"
+#include "xmalloc.h"
+
+#ifdef WITH_AIXAUTHENTICATE
+# include <login.h>
+#endif
+#ifdef HAVE_HPUX_TRUSTED_SYSTEM_PW
+# include <hpsecurity.h>
+# include <prot.h>
+#endif
+#ifdef HAVE_SHADOW_H
+# include <shadow.h>
+#endif
+#ifdef HAVE_GETPWANAM
+# include <sys/label.h>
+# include <sys/audit.h>
+# include <pwdadj.h>
+#endif
+#if defined(HAVE_MD5_PASSWORDS) && !defined(HAVE_MD5_CRYPT)
+# include "md5crypt.h"
+#endif /* defined(HAVE_MD5_PASSWORDS) && !defined(HAVE_MD5_CRYPT) */
+
+#ifdef SECURID
+#include "sdi_athd.h"
+#include "sdconf.h"
+#include "sdacmvls.h"
+
+union config_record configure;
+#endif
+
+/*
+ * Tries to authenticate the user using password.  Returns true if
+ * authentication succeeds.
+ */
+#define INBUFFLEN 256
+
+int
+securid_usersfile_find(const char *pw_name)
+{
+	extern ServerOptions options;
+	FILE *inf;
+	char inbuff[INBUFFLEN];
+	struct stat fileinfo;
+	int retval = 0;
+
+	if(!options.securid_usersfile) {
+		error("In securid_usersfile_find() with NULL filename!");
+		return -1;
+	}
+	if(lstat(options.securid_usersfile, &fileinfo)) {
+		error("Cannot open %s: %s",
+		      options.securid_usersfile, strerror(errno));
+		return -1;
+	}
+	if(fileinfo.st_mode & (S_IWOTH|S_IWGRP)) {
+		error("SecurIDUsersFile is writeable by group and other");
+		return -1;
+	}
+	if(!(inf = fopen(options.securid_usersfile, "r"))) {
+		error("Cannot open %s: %s",
+		      options.securid_usersfile, strerror(errno));
+		return -1;
+	}
+	while(fgets(inbuff,INBUFFLEN-1,inf) != NULL) {
+		if(inbuff[strlen(inbuff) - 1] == '\n')
+			inbuff[strlen(inbuff) - 1] = '\0';
+		retval = !strcmp(inbuff,pw_name);
+		if(retval) break;
+        }
+	fclose(inf);
+	if(retval) return 1;
+	debug2("Failed to find %s in %s",
+		pw_name, options.securid_usersfile);
+	return 0;
+}
+int
+auth_securid_password(struct passwd * pw, const char *password)
+{
+	static int state = 0;	/* This tells us where we expect a
+					0 "PIN"
+					1 "Next Token"
+				*/
+	int doauth;
+	char *ecp;
+	extern ServerOptions options;
+#ifndef SECURID
+	return -1;
+#else
+	/* Add static for the nexttoken case -- Anders Olsen 20010409 */
+	static struct SD_CLIENT sd_dat, *sd;
+
+	/* Check for users with no sdshell and pass them by. */
+	if(options.securid_usersfile) {
+		doauth = securid_usersfile_find(pw->pw_name);
+		if(doauth == 0) {	/* file is there, user is not */
+			if(options.allow_nonsecurid) return -1;
+			return 0;
+		} else if(doauth < 0) { /* File not there or bad perms! */
+			error("Failing SecurID login attempt");
+			return 0;	/* Fail */
+		}
+	} else {
+		/* No users securid_usersfile
+		   so use shells that end in sdshell */
+		if (!((ecp = strstr(pw->pw_shell, "sdshell")) &&
+				(*(ecp+8)=='\0')))
+			if(options.allow_nonsecurid) return -1;
+		else
+			return 0;
+	}
+	/* sd_check on with an empty password causes segfault against some
+		versions of sdiclient -- Anders Olsen 20010409 */
+	if (*password == '\0') {
+		debug2("auth_securid_password: empty password, skipping");
+		return 0;
+	}
+	/* Don't reopen session to securid-server is nexttoken
+		-- Adres Olsen 20010410 */
+	if (state == 0) {
+		int ret;
+		memset(&sd_dat, 0, sizeof(sd_dat));   /* clear struct */
+		sd = &sd_dat;
+
+		if(creadcfg()) {
+			/* Can't read sdconf.rec!  Gotta bail */
+			packet_send_debug("Couldn't read sdconf.rec.");
+			if(options.securid_fallback) return -1;
+			return 0;
+		}
+		if(sd_init(sd)) {
+			/* Can't establish client/server comms!  Gotta bail */
+			packet_send_debug("Couldn't establish client/server communications.");
+			if(options.securid_fallback) return -1;
+			return 0;
+		}
+		/* Auth PIN... */
+		ret = sd_check(password, pw->pw_name, sd);
+		if(ret == ACM_OK) {
+			goto success;
+		}
+		if(ret == ACM_ACCESS_DENIED) {
+			packet_send_debug("SecurID passcode rejected.");
+			return 0; /* Failed! */
+		}
+		if(ret == ACM_NEXT_CODE_REQUIRED) {
+			packet_send_debug("SecurID needs next token.");
+			state = 1; /* Process next try as sd_next */
+			return 0;  /* Fail, so ssh will prmpt again */
+		}
+	} else {
+		/* Auth next token... */
+		int ret;
+		state = 0;  /* Set back to PIN mode */
+		ret = sd_next(password, sd);
+		if(ret == ACM_OK) {
+			goto success;
+		}
+		packet_send_debug("SecurID passcode rejected.");
+		return 0; /* Failed */
+	}
+	packet_send_debug("Unhandled sdcheck() return code.");
+	return 0; /* Failed! */
+
+success:
+	/* We don't free pw->pw_shell here, becuase we don't know how it was
+	   allocated... Besides it is a very small, one-time leak if we did
+	   need to free it. */
+	if(!options.securid_ignore_shell)
+		pw->pw_shell = strdup(sd->shell);
+	packet_send_debug("SecurID passcode accepted.");
+	return 1; /* Success */
+#endif
+}
diff -ruN openssh-2.9p1-orig/config.h.in openssh-2.9p1/config.h.in
--- openssh-2.9p1-orig/config.h.in	Sun Apr 29 21:49:45 2001
+++ openssh-2.9p1/config.h.in	Sun Apr 29 22:00:53 2001
@@ -193,6 +193,9 @@
 /* Define if you want S/Key support */
 #undef SKEY
 
+/* Define if you want SecurID support */
+#undef SECURID
+
 /* Define if you want TCP Wrappers support */
 #undef LIBWRAP
 
diff -ruN openssh-2.9p1-orig/configure openssh-2.9p1/configure
--- openssh-2.9p1-orig/configure	Sun Apr 29 21:49:46 2001
+++ openssh-2.9p1/configure	Sun Apr 29 22:00:56 2001
@@ -24,6 +24,8 @@
 ac_help="$ac_help
   --with-skey=PATH         Enable S/Key support"
 ac_help="$ac_help
+  --with-securid          Enable SecurID support"
+ac_help="$ac_help
   --with-tcp-wrappers     Enable tcpwrappers support"
 ac_help="$ac_help
   --with-pam              Enable PAM support "
@@ -599,7 +601,7 @@
 # Extract the first word of "gcc", so it can be a program name with args.
 set dummy gcc; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:603: checking for $ac_word" >&5
+echo "configure:605: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -629,7 +631,7 @@
   # Extract the first word of "cc", so it can be a program name with args.
 set dummy cc; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:633: checking for $ac_word" >&5
+echo "configure:635: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -680,7 +682,7 @@
       # Extract the first word of "cl", so it can be a program name with args.
 set dummy cl; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:684: checking for $ac_word" >&5
+echo "configure:686: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -712,7 +714,7 @@
 fi
 
 echo $ac_n "checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works""... $ac_c" 1>&6
-echo "configure:716: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works" >&5
+echo "configure:718: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works" >&5
 
 ac_ext=c
 # CFLAGS is not in ac_cpp because -g, -O, etc. are not valid cpp options.
@@ -723,12 +725,12 @@
 
 cat > conftest.$ac_ext << EOF
 
-#line 727 "configure"
+#line 729 "configure"
 #include "confdefs.h"
 
 main(){return(0);}
 EOF
-if { (eval echo configure:732: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:734: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   ac_cv_prog_cc_works=yes
   # If we can't run a trivial program, we are probably using a cross compiler.
   if (./conftest; exit) 2>/dev/null; then
@@ -754,12 +756,12 @@
   { echo "configure: error: installation or configuration problem: C compiler cannot create executables." 1>&2; exit 1; }
 fi
 echo $ac_n "checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler""... $ac_c" 1>&6
-echo "configure:758: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler" >&5
+echo "configure:760: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler" >&5
 echo "$ac_t""$ac_cv_prog_cc_cross" 1>&6
 cross_compiling=$ac_cv_prog_cc_cross
 
 echo $ac_n "checking whether we are using GNU C""... $ac_c" 1>&6
-echo "configure:763: checking whether we are using GNU C" >&5
+echo "configure:765: checking whether we are using GNU C" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_gcc'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -768,7 +770,7 @@
   yes;
 #endif
 EOF
-if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:772: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then
+if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:774: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then
   ac_cv_prog_gcc=yes
 else
   ac_cv_prog_gcc=no
@@ -787,7 +789,7 @@
 ac_save_CFLAGS="$CFLAGS"
 CFLAGS=
 echo $ac_n "checking whether ${CC-cc} accepts -g""... $ac_c" 1>&6
-echo "configure:791: checking whether ${CC-cc} accepts -g" >&5
+echo "configure:793: checking whether ${CC-cc} accepts -g" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_cc_g'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -844,7 +846,7 @@
 fi
 
 echo $ac_n "checking host system type""... $ac_c" 1>&6
-echo "configure:848: checking host system type" >&5
+echo "configure:850: checking host system type" >&5
 
 host_alias=$host
 case "$host_alias" in
@@ -865,14 +867,14 @@
 echo "$ac_t""$host" 1>&6
 
 echo $ac_n "checking whether byte ordering is bigendian""... $ac_c" 1>&6
-echo "configure:869: checking whether byte ordering is bigendian" >&5
+echo "configure:871: checking whether byte ordering is bigendian" >&5
 if eval "test \"`echo '$''{'ac_cv_c_bigendian'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   ac_cv_c_bigendian=unknown
 # See if sys/param.h defines the BYTE_ORDER macro.
 cat > conftest.$ac_ext <<EOF
-#line 876 "configure"
+#line 878 "configure"
 #include "confdefs.h"
 #include <sys/types.h>
 #include <sys/param.h>
@@ -883,11 +885,11 @@
 #endif
 ; return 0; }
 EOF
-if { (eval echo configure:887: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:889: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   # It does; now see whether it defined to BIG_ENDIAN or not.
 cat > conftest.$ac_ext <<EOF
-#line 891 "configure"
+#line 893 "configure"
 #include "confdefs.h"
 #include <sys/types.h>
 #include <sys/param.h>
@@ -898,7 +900,7 @@
 #endif
 ; return 0; }
 EOF
-if { (eval echo configure:902: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:904: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   ac_cv_c_bigendian=yes
 else
@@ -918,7 +920,7 @@
     { echo "configure: error: can not run test program while cross compiling" 1>&2; exit 1; }
 else
   cat > conftest.$ac_ext <<EOF
-#line 922 "configure"
+#line 924 "configure"
 #include "confdefs.h"
 main () {
   /* Are we little or big endian?  From Harbison&Steele.  */
@@ -931,7 +933,7 @@
   exit (u.c[sizeof (long) - 1] == 1);
 }
 EOF
-if { (eval echo configure:935: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:937: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   ac_cv_c_bigendian=no
 else
@@ -957,7 +959,7 @@
 
 # Checks for programs.
 echo $ac_n "checking how to run the C preprocessor""... $ac_c" 1>&6
-echo "configure:961: checking how to run the C preprocessor" >&5
+echo "configure:963: checking how to run the C preprocessor" >&5
 # On Suns, sometimes $CPP names a directory.
 if test -n "$CPP" && test -d "$CPP"; then
   CPP=
@@ -972,13 +974,13 @@
   # On the NeXT, cc -E runs the code through the compiler's parser,
   # not just through cpp.
   cat > conftest.$ac_ext <<EOF
-#line 976 "configure"
+#line 978 "configure"
 #include "confdefs.h"
 #include <assert.h>
 Syntax Error
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:982: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:984: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
 ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   :
@@ -989,13 +991,13 @@
   rm -rf conftest*
   CPP="${CC-cc} -E -traditional-cpp"
   cat > conftest.$ac_ext <<EOF
-#line 993 "configure"
+#line 995 "configure"
 #include "confdefs.h"
 #include <assert.h>
 Syntax Error
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:999: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:1001: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
 ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   :
@@ -1006,13 +1008,13 @@
   rm -rf conftest*
   CPP="${CC-cc} -nologo -E"
   cat > conftest.$ac_ext <<EOF
-#line 1010 "configure"
+#line 1012 "configure"
 #include "confdefs.h"
 #include <assert.h>
 Syntax Error
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:1016: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:1018: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
 ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   :
@@ -1039,7 +1041,7 @@
 # Extract the first word of "ranlib", so it can be a program name with args.
 set dummy ranlib; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:1043: checking for $ac_word" >&5
+echo "configure:1045: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_RANLIB'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1078,7 +1080,7 @@
 # SVR4 /usr/ucb/install, which tries to use the nonexistent group "staff"
 # ./install, which can be erroneously created by make from ./install.sh.
 echo $ac_n "checking for a BSD compatible install""... $ac_c" 1>&6
-echo "configure:1082: checking for a BSD compatible install" >&5
+echo "configure:1084: checking for a BSD compatible install" >&5
 if test -z "$INSTALL"; then
 if eval "test \"`echo '$''{'ac_cv_path_install'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -1133,7 +1135,7 @@
 # Extract the first word of "ar", so it can be a program name with args.
 set dummy ar; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:1137: checking for $ac_word" >&5
+echo "configure:1139: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_AR'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1170,7 +1172,7 @@
 # Extract the first word of "$ac_prog", so it can be a program name with args.
 set dummy $ac_prog; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:1174: checking for $ac_word" >&5
+echo "configure:1176: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PERL'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1209,7 +1211,7 @@
 # Extract the first word of "ent", so it can be a program name with args.
 set dummy ent; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:1213: checking for $ac_word" >&5
+echo "configure:1215: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_ENT'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1247,7 +1249,7 @@
 # Extract the first word of "$ac_prog", so it can be a program name with args.
 set dummy $ac_prog; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:1251: checking for $ac_word" >&5
+echo "configure:1253: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_FILEPRIV'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1286,7 +1288,7 @@
 # Extract the first word of "bash", so it can be a program name with args.
 set dummy bash; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:1290: checking for $ac_word" >&5
+echo "configure:1292: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_TEST_MINUS_S_SH'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1321,7 +1323,7 @@
 # Extract the first word of "ksh", so it can be a program name with args.
 set dummy ksh; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:1325: checking for $ac_word" >&5
+echo "configure:1327: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_TEST_MINUS_S_SH'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1356,7 +1358,7 @@
 # Extract the first word of "sh", so it can be a program name with args.
 set dummy sh; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:1360: checking for $ac_word" >&5
+echo "configure:1362: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_TEST_MINUS_S_SH'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1404,7 +1406,7 @@
 	# Extract the first word of "login", so it can be a program name with args.
 set dummy login; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:1408: checking for $ac_word" >&5
+echo "configure:1410: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_LOGIN_PROGRAM_FALLBACK'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1451,21 +1453,21 @@
 	
 # C Compiler features
 echo $ac_n "checking for inline""... $ac_c" 1>&6
-echo "configure:1455: checking for inline" >&5
+echo "configure:1457: checking for inline" >&5
 if eval "test \"`echo '$''{'ac_cv_c_inline'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   ac_cv_c_inline=no
 for ac_kw in inline __inline__ __inline; do
   cat > conftest.$ac_ext <<EOF
-#line 1462 "configure"
+#line 1464 "configure"
 #include "confdefs.h"
 
 int main() {
 } $ac_kw foo() {
 ; return 0; }
 EOF
-if { (eval echo configure:1469: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:1471: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   ac_cv_c_inline=$ac_kw; break
 else
@@ -1504,12 +1506,12 @@
 		blibpath="/usr/lib:/lib:/usr/local/lib"
 	fi
 	echo $ac_n "checking for authenticate""... $ac_c" 1>&6
-echo "configure:1508: checking for authenticate" >&5
+echo "configure:1510: checking for authenticate" >&5
 if eval "test \"`echo '$''{'ac_cv_func_authenticate'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 1513 "configure"
+#line 1515 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char authenticate(); below.  */
@@ -1532,7 +1534,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:1536: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:1538: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_authenticate=yes"
 else
@@ -1671,12 +1673,12 @@
 EOF
 
 	echo $ac_n "checking for jlimit_startjob""... $ac_c" 1>&6
-echo "configure:1675: checking for jlimit_startjob" >&5
+echo "configure:1677: checking for jlimit_startjob" >&5
 if eval "test \"`echo '$''{'ac_cv_func_jlimit_startjob'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 1680 "configure"
+#line 1682 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char jlimit_startjob(); below.  */
@@ -1699,7 +1701,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:1703: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:1705: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_jlimit_startjob=yes"
 else
@@ -1748,7 +1750,7 @@
 
 	SONY=1
 	echo $ac_n "checking for xatexit in -liberty""... $ac_c" 1>&6
-echo "configure:1752: checking for xatexit in -liberty" >&5
+echo "configure:1754: checking for xatexit in -liberty" >&5
 ac_lib_var=`echo iberty'_'xatexit | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -1756,7 +1758,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-liberty  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 1760 "configure"
+#line 1762 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -1767,7 +1769,7 @@
 xatexit()
 ; return 0; }
 EOF
-if { (eval echo configure:1771: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:1773: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -1834,7 +1836,7 @@
 	# hardwire lastlog location (can't detect it on some versions)
 	conf_lastlog_location="/var/adm/lastlog"
 	echo $ac_n "checking for obsolete utmp and wtmp in solaris2.x""... $ac_c" 1>&6
-echo "configure:1838: checking for obsolete utmp and wtmp in solaris2.x" >&5
+echo "configure:1840: checking for obsolete utmp and wtmp in solaris2.x" >&5
 	sol2ver=`echo "$host"| sed -e 's/.*[0-9]\.//'`
 	if test "$sol2ver" -ge 8; then
 		echo "$ac_t""yes" 1>&6
@@ -1855,12 +1857,12 @@
 	for ac_func in getpwanam
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:1859: checking for $ac_func" >&5
+echo "configure:1861: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 1864 "configure"
+#line 1866 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -1883,7 +1885,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:1887: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:1889: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -2007,12 +2009,12 @@
 	for ac_func in getluid setluid
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:2011: checking for $ac_func" >&5
+echo "configure:2013: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 2016 "configure"
+#line 2018 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -2035,7 +2037,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:2039: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2041: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -2086,12 +2088,12 @@
 	for ac_func in getluid setluid
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:2090: checking for $ac_func" >&5
+echo "configure:2092: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 2095 "configure"
+#line 2097 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -2114,7 +2116,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:2118: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2120: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -2143,7 +2145,7 @@
 *-dec-osf*)
 	if test ! -z "USE_SIA" ; then
 		echo $ac_n "checking for Digital Unix Security Integration Architecture""... $ac_c" 1>&6
-echo "configure:2147: checking for Digital Unix Security Integration Architecture" >&5
+echo "configure:2149: checking for Digital Unix Security Integration Architecture" >&5
 		if test -f /etc/sia/matrix.conf; then
 			echo "$ac_t""yes" 1>&6
 			cat >> confdefs.h <<\EOF
@@ -2214,7 +2216,7 @@
   
 
 		echo $ac_n "checking for pcre_info in -lpcre""... $ac_c" 1>&6
-echo "configure:2218: checking for pcre_info in -lpcre" >&5
+echo "configure:2220: checking for pcre_info in -lpcre" >&5
 ac_lib_var=`echo pcre'_'pcre_info | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -2222,7 +2224,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lpcre  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 2226 "configure"
+#line 2228 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -2233,7 +2235,7 @@
 pcre_info()
 ; return 0; }
 EOF
-if { (eval echo configure:2237: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2239: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -2270,7 +2272,7 @@
 # Checks for libraries.
 if test -z "$no_libnsl" ; then
 	echo $ac_n "checking for yp_match in -lnsl""... $ac_c" 1>&6
-echo "configure:2274: checking for yp_match in -lnsl" >&5
+echo "configure:2276: checking for yp_match in -lnsl" >&5
 ac_lib_var=`echo nsl'_'yp_match | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -2278,7 +2280,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lnsl  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 2282 "configure"
+#line 2284 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -2289,7 +2291,7 @@
 yp_match()
 ; return 0; }
 EOF
-if { (eval echo configure:2293: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2295: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -2319,7 +2321,7 @@
 fi
 if test -z "$no_libsocket" ; then
 	echo $ac_n "checking for main in -lsocket""... $ac_c" 1>&6
-echo "configure:2323: checking for main in -lsocket" >&5
+echo "configure:2325: checking for main in -lsocket" >&5
 ac_lib_var=`echo socket'_'main | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -2327,14 +2329,14 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lsocket  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 2331 "configure"
+#line 2333 "configure"
 #include "confdefs.h"
 
 int main() {
 main()
 ; return 0; }
 EOF
-if { (eval echo configure:2338: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2340: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -2364,7 +2366,7 @@
 fi
 
 echo $ac_n "checking for innetgr in -lrpc""... $ac_c" 1>&6
-echo "configure:2368: checking for innetgr in -lrpc" >&5
+echo "configure:2370: checking for innetgr in -lrpc" >&5
 ac_lib_var=`echo rpc'_'innetgr | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -2372,7 +2374,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lrpc -lyp -lrpc $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 2376 "configure"
+#line 2378 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -2383,7 +2385,7 @@
 innetgr()
 ; return 0; }
 EOF
-if { (eval echo configure:2387: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2389: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -2405,7 +2407,7 @@
 
 
 echo $ac_n "checking for getspnam in -lgen""... $ac_c" 1>&6
-echo "configure:2409: checking for getspnam in -lgen" >&5
+echo "configure:2411: checking for getspnam in -lgen" >&5
 ac_lib_var=`echo gen'_'getspnam | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -2413,7 +2415,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lgen  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 2417 "configure"
+#line 2419 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -2424,7 +2426,7 @@
 getspnam()
 ; return 0; }
 EOF
-if { (eval echo configure:2428: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2430: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -2445,7 +2447,7 @@
 fi
 
 echo $ac_n "checking for deflate in -lz""... $ac_c" 1>&6
-echo "configure:2449: checking for deflate in -lz" >&5
+echo "configure:2451: checking for deflate in -lz" >&5
 ac_lib_var=`echo z'_'deflate | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -2453,7 +2455,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lz  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 2457 "configure"
+#line 2459 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -2464,7 +2466,7 @@
 deflate()
 ; return 0; }
 EOF
-if { (eval echo configure:2468: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2470: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -2493,7 +2495,7 @@
 fi
 
 echo $ac_n "checking for login in -lutil""... $ac_c" 1>&6
-echo "configure:2497: checking for login in -lutil" >&5
+echo "configure:2499: checking for login in -lutil" >&5
 ac_lib_var=`echo util'_'login | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -2501,7 +2503,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lutil  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 2505 "configure"
+#line 2507 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -2512,7 +2514,7 @@
 login()
 ; return 0; }
 EOF
-if { (eval echo configure:2516: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2518: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -2539,12 +2541,12 @@
 # We don't want to check if we did an pcre override.
 if test -z "$no_comp_check" ; then
 	echo $ac_n "checking for regcomp""... $ac_c" 1>&6
-echo "configure:2543: checking for regcomp" >&5
+echo "configure:2545: checking for regcomp" >&5
 if eval "test \"`echo '$''{'ac_cv_func_regcomp'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 2548 "configure"
+#line 2550 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char regcomp(); below.  */
@@ -2567,7 +2569,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:2571: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2573: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_regcomp=yes"
 else
@@ -2589,7 +2591,7 @@
   echo "$ac_t""no" 1>&6
 
 			echo $ac_n "checking for pcre_info in -lpcre""... $ac_c" 1>&6
-echo "configure:2593: checking for pcre_info in -lpcre" >&5
+echo "configure:2595: checking for pcre_info in -lpcre" >&5
 ac_lib_var=`echo pcre'_'pcre_info | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -2597,7 +2599,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lpcre  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 2601 "configure"
+#line 2603 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -2608,7 +2610,7 @@
 pcre_info()
 ; return 0; }
 EOF
-if { (eval echo configure:2612: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2614: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -2644,12 +2646,12 @@
 fi
 
 echo $ac_n "checking for strcasecmp""... $ac_c" 1>&6
-echo "configure:2648: checking for strcasecmp" >&5
+echo "configure:2650: checking for strcasecmp" >&5
 if eval "test \"`echo '$''{'ac_cv_func_strcasecmp'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 2653 "configure"
+#line 2655 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char strcasecmp(); below.  */
@@ -2672,7 +2674,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:2676: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2678: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_strcasecmp=yes"
 else
@@ -2690,7 +2692,7 @@
 else
   echo "$ac_t""no" 1>&6
  echo $ac_n "checking for strcasecmp in -lresolv""... $ac_c" 1>&6
-echo "configure:2694: checking for strcasecmp in -lresolv" >&5
+echo "configure:2696: checking for strcasecmp in -lresolv" >&5
 ac_lib_var=`echo resolv'_'strcasecmp | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -2698,7 +2700,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lresolv  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 2702 "configure"
+#line 2704 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -2709,7 +2711,7 @@
 strcasecmp()
 ; return 0; }
 EOF
-if { (eval echo configure:2713: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2715: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -2733,12 +2735,12 @@
 fi
 
 echo $ac_n "checking for utimes""... $ac_c" 1>&6
-echo "configure:2737: checking for utimes" >&5
+echo "configure:2739: checking for utimes" >&5
 if eval "test \"`echo '$''{'ac_cv_func_utimes'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 2742 "configure"
+#line 2744 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char utimes(); below.  */
@@ -2761,7 +2763,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:2765: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2767: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_utimes=yes"
 else
@@ -2779,7 +2781,7 @@
 else
   echo "$ac_t""no" 1>&6
  echo $ac_n "checking for utimes in -lc89""... $ac_c" 1>&6
-echo "configure:2783: checking for utimes in -lc89" >&5
+echo "configure:2785: checking for utimes in -lc89" >&5
 ac_lib_var=`echo c89'_'utimes | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -2787,7 +2789,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lc89  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 2791 "configure"
+#line 2793 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -2798,7 +2800,7 @@
 utimes()
 ; return 0; }
 EOF
-if { (eval echo configure:2802: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2804: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -2823,12 +2825,12 @@
 
 
 echo $ac_n "checking for strftime""... $ac_c" 1>&6
-echo "configure:2827: checking for strftime" >&5
+echo "configure:2829: checking for strftime" >&5
 if eval "test \"`echo '$''{'ac_cv_func_strftime'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 2832 "configure"
+#line 2834 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char strftime(); below.  */
@@ -2851,7 +2853,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:2855: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2857: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_strftime=yes"
 else
@@ -2873,7 +2875,7 @@
   echo "$ac_t""no" 1>&6
 # strftime is in -lintl on SCO UNIX.
 echo $ac_n "checking for strftime in -lintl""... $ac_c" 1>&6
-echo "configure:2877: checking for strftime in -lintl" >&5
+echo "configure:2879: checking for strftime in -lintl" >&5
 ac_lib_var=`echo intl'_'strftime | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -2881,7 +2883,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lintl  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 2885 "configure"
+#line 2887 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -2892,7 +2894,7 @@
 strftime()
 ; return 0; }
 EOF
-if { (eval echo configure:2896: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2898: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -2924,17 +2926,17 @@
 do
 ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
-echo "configure:2928: checking for $ac_hdr" >&5
+echo "configure:2930: checking for $ac_hdr" >&5
 if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 2933 "configure"
+#line 2935 "configure"
 #include "confdefs.h"
 #include <$ac_hdr>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:2938: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:2940: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
 ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -2963,9 +2965,9 @@
 
 # Check for ALTDIRFUNC glob() extension
 echo $ac_n "checking for GLOB_ALTDIRFUNC support""... $ac_c" 1>&6
-echo "configure:2967: checking for GLOB_ALTDIRFUNC support" >&5
+echo "configure:2969: checking for GLOB_ALTDIRFUNC support" >&5
 cat > conftest.$ac_ext <<EOF
-#line 2969 "configure"
+#line 2971 "configure"
 #include "confdefs.h"
 
 		#include <glob.h>
@@ -2996,9 +2998,9 @@
 
 # Check for g.gl_matchc glob() extension
 echo $ac_n "checking for gl_matchc field in glob_t""... $ac_c" 1>&6
-echo "configure:3000: checking for gl_matchc field in glob_t" >&5
+echo "configure:3002: checking for gl_matchc field in glob_t" >&5
 cat > conftest.$ac_ext <<EOF
-#line 3002 "configure"
+#line 3004 "configure"
 #include "confdefs.h"
 
                 #include <glob.h>
@@ -3026,12 +3028,12 @@
 
 
 echo $ac_n "checking whether struct dirent allocates space for d_name""... $ac_c" 1>&6
-echo "configure:3030: checking whether struct dirent allocates space for d_name" >&5
+echo "configure:3032: checking whether struct dirent allocates space for d_name" >&5
 if test "$cross_compiling" = yes; then
     { echo "configure: error: can not run test program while cross compiling" 1>&2; exit 1; }
 else
   cat > conftest.$ac_ext <<EOF
-#line 3035 "configure"
+#line 3037 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -3039,7 +3041,7 @@
 int main(void){struct dirent d;return(sizeof(d.d_name)<=sizeof(char));}
 	
 EOF
-if { (eval echo configure:3043: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:3045: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   echo "$ac_t""yes" 1>&6
 else
@@ -3080,12 +3082,12 @@
 			SKEY_MSG="yes" 
 	
 			echo $ac_n "checking for skey_keyinfo""... $ac_c" 1>&6
-echo "configure:3084: checking for skey_keyinfo" >&5
+echo "configure:3086: checking for skey_keyinfo" >&5
 if eval "test \"`echo '$''{'ac_cv_func_skey_keyinfo'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3089 "configure"
+#line 3091 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char skey_keyinfo(); below.  */
@@ -3108,7 +3110,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:3112: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3114: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_skey_keyinfo=yes"
 else
@@ -3135,6 +3137,55 @@
 
 fi
 
+SECURID_MSG="no"
+# Check whether --with-securid or --without-securid was given.
+if test "${with_securid+set}" = set; then
+  withval="$with_securid"
+  
+		if test "x$withval" != "xno" ; then
+			saved_LIBS="$LIBS"
+			LIBS="$LIBS sdiclient.a"
+			echo $ac_n "checking for sdiclient.a""... $ac_c" 1>&6
+echo "configure:3150: checking for sdiclient.a" >&5
+			cat > conftest.$ac_ext <<EOF
+#line 3152 "configure"
+#include "confdefs.h"
+
+#include "sdi_athd.h"
+#include "sdconf.h"
+#include "sdacmvls.h"
+					struct SD_CLIENT sd_dat, *sd;
+					union config_record configure;
+				
+int main() {
+sd = &sd_dat; creadcfg(); sd_init(sd);
+; return 0; }
+EOF
+if { (eval echo configure:3165: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  
+					echo "$ac_t""yes" 1>&6
+					cat >> confdefs.h <<\EOF
+#define SECURID 1
+EOF
+
+					SECURID_MSG="yes" 
+				
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  
+					{ echo "configure: error: *** sdiclient.a missing" 1>&2; exit 1; }
+				
+			
+fi
+rm -f conftest*
+		fi
+	
+
+fi
+
 
 # Check whether user wants TCP wrappers support
 TCPW_MSG="no" 
@@ -3146,9 +3197,9 @@
 			saved_LIBS="$LIBS"
 			LIBS="-lwrap $LIBS"
 			echo $ac_n "checking for libwrap""... $ac_c" 1>&6
-echo "configure:3150: checking for libwrap" >&5
+echo "configure:3201: checking for libwrap" >&5
 			cat > conftest.$ac_ext <<EOF
-#line 3152 "configure"
+#line 3203 "configure"
 #include "confdefs.h"
 
 #include <tcpd.h>
@@ -3158,7 +3209,7 @@
 hosts_access(0);
 ; return 0; }
 EOF
-if { (eval echo configure:3162: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3213: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   
 					echo "$ac_t""yes" 1>&6
@@ -3187,12 +3238,12 @@
 for ac_func in arc4random atexit b64_ntop bcopy bindresvport_sa clock fchown fchmod freeaddrinfo futimes gai_strerror getcwd getaddrinfo getgrouplist getnameinfo getrlimit getrusage getttyent getusershell glob inet_aton inet_ntoa inet_ntop innetgr login_getcapbool md5_crypt memmove mkdtemp on_exit openpty realpath rresvport_af setdtablesize setenv setegid seteuid setlogin setproctitle setresgid setreuid setrlimit setsid sigaction sigvec snprintf strerror strlcat strlcpy strmode strsep strtok_r sysconf tcgetpgrp utimes vsnprintf vhangup vis waitpid _getpty __b64_ntop
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:3191: checking for $ac_func" >&5
+echo "configure:3242: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3196 "configure"
+#line 3247 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -3215,7 +3266,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:3219: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3270: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -3242,12 +3293,12 @@
 for ac_func in gettimeofday time
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:3246: checking for $ac_func" >&5
+echo "configure:3297: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3251 "configure"
+#line 3302 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -3270,7 +3321,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:3274: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3325: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -3298,17 +3349,17 @@
 do
 ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
-echo "configure:3302: checking for $ac_hdr" >&5
+echo "configure:3353: checking for $ac_hdr" >&5
 if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3307 "configure"
+#line 3358 "configure"
 #include "confdefs.h"
 #include <$ac_hdr>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:3312: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:3363: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
 ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -3337,12 +3388,12 @@
 for ac_func in login logout updwtmp logwtmp
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:3341: checking for $ac_func" >&5
+echo "configure:3392: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3346 "configure"
+#line 3397 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -3365,7 +3416,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:3369: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3420: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -3392,12 +3443,12 @@
 for ac_func in endutent getutent getutid getutline pututline setutent
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:3396: checking for $ac_func" >&5
+echo "configure:3447: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3401 "configure"
+#line 3452 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -3420,7 +3471,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:3424: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3475: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -3447,12 +3498,12 @@
 for ac_func in utmpname
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:3451: checking for $ac_func" >&5
+echo "configure:3502: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3456 "configure"
+#line 3507 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -3475,7 +3526,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:3479: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3530: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -3502,12 +3553,12 @@
 for ac_func in endutxent getutxent getutxid getutxline pututxline 
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:3506: checking for $ac_func" >&5
+echo "configure:3557: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3511 "configure"
+#line 3562 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -3530,7 +3581,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:3534: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3585: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -3557,12 +3608,12 @@
 for ac_func in setutxent utmpxname
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:3561: checking for $ac_func" >&5
+echo "configure:3612: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3566 "configure"
+#line 3617 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -3585,7 +3636,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:3589: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3640: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -3611,12 +3662,12 @@
 
 
 echo $ac_n "checking for getuserattr""... $ac_c" 1>&6
-echo "configure:3615: checking for getuserattr" >&5
+echo "configure:3666: checking for getuserattr" >&5
 if eval "test \"`echo '$''{'ac_cv_func_getuserattr'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3620 "configure"
+#line 3671 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char getuserattr(); below.  */
@@ -3639,7 +3690,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:3643: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3694: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_getuserattr=yes"
 else
@@ -3660,7 +3711,7 @@
 else
   echo "$ac_t""no" 1>&6
 echo $ac_n "checking for getuserattr in -ls""... $ac_c" 1>&6
-echo "configure:3664: checking for getuserattr in -ls" >&5
+echo "configure:3715: checking for getuserattr in -ls" >&5
 ac_lib_var=`echo s'_'getuserattr | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -3668,7 +3719,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-ls  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 3672 "configure"
+#line 3723 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -3679,7 +3730,7 @@
 getuserattr()
 ; return 0; }
 EOF
-if { (eval echo configure:3683: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3734: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -3707,12 +3758,12 @@
 
 
 echo $ac_n "checking for login""... $ac_c" 1>&6
-echo "configure:3711: checking for login" >&5
+echo "configure:3762: checking for login" >&5
 if eval "test \"`echo '$''{'ac_cv_func_login'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3716 "configure"
+#line 3767 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char login(); below.  */
@@ -3735,7 +3786,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:3739: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3790: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_login=yes"
 else
@@ -3756,7 +3807,7 @@
 else
   echo "$ac_t""no" 1>&6
 echo $ac_n "checking for login in -lbsd""... $ac_c" 1>&6
-echo "configure:3760: checking for login in -lbsd" >&5
+echo "configure:3811: checking for login in -lbsd" >&5
 ac_lib_var=`echo bsd'_'login | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -3764,7 +3815,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lbsd  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 3768 "configure"
+#line 3819 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -3775,7 +3826,7 @@
 login()
 ; return 0; }
 EOF
-if { (eval echo configure:3779: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3830: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -3803,12 +3854,12 @@
 
 
 echo $ac_n "checking for daemon""... $ac_c" 1>&6
-echo "configure:3807: checking for daemon" >&5
+echo "configure:3858: checking for daemon" >&5
 if eval "test \"`echo '$''{'ac_cv_func_daemon'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3812 "configure"
+#line 3863 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char daemon(); below.  */
@@ -3831,7 +3882,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:3835: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3886: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_daemon=yes"
 else
@@ -3852,7 +3903,7 @@
 else
   echo "$ac_t""no" 1>&6
 echo $ac_n "checking for daemon in -lbsd""... $ac_c" 1>&6
-echo "configure:3856: checking for daemon in -lbsd" >&5
+echo "configure:3907: checking for daemon in -lbsd" >&5
 ac_lib_var=`echo bsd'_'daemon | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -3860,7 +3911,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lbsd  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 3864 "configure"
+#line 3915 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -3871,7 +3922,7 @@
 daemon()
 ; return 0; }
 EOF
-if { (eval echo configure:3875: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3926: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -3899,12 +3950,12 @@
 
 
 echo $ac_n "checking for getpagesize""... $ac_c" 1>&6
-echo "configure:3903: checking for getpagesize" >&5
+echo "configure:3954: checking for getpagesize" >&5
 if eval "test \"`echo '$''{'ac_cv_func_getpagesize'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3908 "configure"
+#line 3959 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char getpagesize(); below.  */
@@ -3927,7 +3978,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:3931: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3982: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_getpagesize=yes"
 else
@@ -3948,7 +3999,7 @@
 else
   echo "$ac_t""no" 1>&6
 echo $ac_n "checking for getpagesize in -lucb""... $ac_c" 1>&6
-echo "configure:3952: checking for getpagesize in -lucb" >&5
+echo "configure:4003: checking for getpagesize in -lucb" >&5
 ac_lib_var=`echo ucb'_'getpagesize | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -3956,7 +4007,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lucb  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 3960 "configure"
+#line 4011 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -3967,7 +4018,7 @@
 getpagesize()
 ; return 0; }
 EOF
-if { (eval echo configure:3971: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4022: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -3997,19 +4048,19 @@
 # Check for broken snprintf
 if test "x$ac_cv_func_snprintf" = "xyes" ; then
 	echo $ac_n "checking whether snprintf correctly terminates long strings""... $ac_c" 1>&6
-echo "configure:4001: checking whether snprintf correctly terminates long strings" >&5
+echo "configure:4052: checking whether snprintf correctly terminates long strings" >&5
 	if test "$cross_compiling" = yes; then
     { echo "configure: error: can not run test program while cross compiling" 1>&2; exit 1; }
 else
   cat > conftest.$ac_ext <<EOF
-#line 4006 "configure"
+#line 4057 "configure"
 #include "confdefs.h"
 
 #include <stdio.h>
 int main(void){char b[5];snprintf(b,5,"123456789");return(b[4]!='\0');}
 		
 EOF
-if { (eval echo configure:4013: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:4064: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   echo "$ac_t""yes" 1>&6
 else
@@ -4032,7 +4083,7 @@
 fi
 
 echo $ac_n "checking whether getpgrp takes no argument""... $ac_c" 1>&6
-echo "configure:4036: checking whether getpgrp takes no argument" >&5
+echo "configure:4087: checking whether getpgrp takes no argument" >&5
 if eval "test \"`echo '$''{'ac_cv_func_getpgrp_void'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -4040,7 +4091,7 @@
   { echo "configure: error: cannot check getpgrp if cross compiling" 1>&2; exit 1; }
 else
   cat > conftest.$ac_ext <<EOF
-#line 4044 "configure"
+#line 4095 "configure"
 #include "confdefs.h"
 
 /*
@@ -4095,7 +4146,7 @@
 }
 
 EOF
-if { (eval echo configure:4099: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:4150: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   ac_cv_func_getpgrp_void=yes
 else
@@ -4131,7 +4182,7 @@
 			fi
 
 			echo $ac_n "checking for dlopen in -ldl""... $ac_c" 1>&6
-echo "configure:4135: checking for dlopen in -ldl" >&5
+echo "configure:4186: checking for dlopen in -ldl" >&5
 ac_lib_var=`echo dl'_'dlopen | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -4139,7 +4190,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-ldl  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 4143 "configure"
+#line 4194 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -4150,7 +4201,7 @@
 dlopen()
 ; return 0; }
 EOF
-if { (eval echo configure:4154: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4205: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -4178,7 +4229,7 @@
 fi
 
 			echo $ac_n "checking for pam_set_item in -lpam""... $ac_c" 1>&6
-echo "configure:4182: checking for pam_set_item in -lpam" >&5
+echo "configure:4233: checking for pam_set_item in -lpam" >&5
 ac_lib_var=`echo pam'_'pam_set_item | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -4186,7 +4237,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lpam  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 4190 "configure"
+#line 4241 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -4197,7 +4248,7 @@
 pam_set_item()
 ; return 0; }
 EOF
-if { (eval echo configure:4201: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4252: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -4228,12 +4279,12 @@
 			for ac_func in pam_getenvlist
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:4232: checking for $ac_func" >&5
+echo "configure:4283: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 4237 "configure"
+#line 4288 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -4256,7 +4307,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:4260: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4311: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -4298,9 +4349,9 @@
 if test "x$PAM_MSG" = "xyes" ; then
 	# Check PAM strerror arguments (old PAM)
 	echo $ac_n "checking whether pam_strerror takes only one argument""... $ac_c" 1>&6
-echo "configure:4302: checking whether pam_strerror takes only one argument" >&5
+echo "configure:4353: checking whether pam_strerror takes only one argument" >&5
 	cat > conftest.$ac_ext <<EOF
-#line 4304 "configure"
+#line 4355 "configure"
 #include "confdefs.h"
 
 #include <stdlib.h>
@@ -4310,7 +4361,7 @@
 (void)pam_strerror((pam_handle_t *)NULL, -1);
 ; return 0; }
 EOF
-if { (eval echo configure:4314: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:4365: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   echo "$ac_t""no" 1>&6
 else
@@ -4350,7 +4401,7 @@
 	tryssldir="$tryssldir $prefix"
 fi
 echo $ac_n "checking for OpenSSL directory""... $ac_c" 1>&6
-echo "configure:4354: checking for OpenSSL directory" >&5
+echo "configure:4405: checking for OpenSSL directory" >&5
 if eval "test \"`echo '$''{'ac_cv_openssldir'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -4393,7 +4444,7 @@
     { echo "configure: error: can not run test program while cross compiling" 1>&2; exit 1; }
 else
   cat > conftest.$ac_ext <<EOF
-#line 4397 "configure"
+#line 4448 "configure"
 #include "confdefs.h"
 
 #include <string.h>
@@ -4407,7 +4458,7 @@
 }
 			
 EOF
-if { (eval echo configure:4411: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:4462: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   
 				found_crypto=1
@@ -4476,7 +4527,7 @@
 # Now test RSA support
 saved_LIBS="$LIBS"
 echo $ac_n "checking for RSA support""... $ac_c" 1>&6
-echo "configure:4480: checking for RSA support" >&5
+echo "configure:4531: checking for RSA support" >&5
 for WANTS_RSAREF in "" 1 ; do
 	if test -z "$WANTS_RSAREF" ; then
 		LIBS="$saved_LIBS"
@@ -4487,7 +4538,7 @@
     { echo "configure: error: can not run test program while cross compiling" 1>&2; exit 1; }
 else
   cat > conftest.$ac_ext <<EOF
-#line 4491 "configure"
+#line 4542 "configure"
 #include "confdefs.h"
 
 #include <string.h>
@@ -4506,7 +4557,7 @@
 }
 	
 EOF
-if { (eval echo configure:4510: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:4561: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   
 		rsa_works=1
@@ -4544,7 +4595,7 @@
 # version in OpenSSL. Skip this for PAM
 if test "x$PAM_MSG" = "xno" -a "x$check_for_libcrypt_later" = "x1"; then
 	echo $ac_n "checking for crypt in -lcrypt""... $ac_c" 1>&6
-echo "configure:4548: checking for crypt in -lcrypt" >&5
+echo "configure:4599: checking for crypt in -lcrypt" >&5
 ac_lib_var=`echo crypt'_'crypt | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -4552,7 +4603,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lcrypt  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 4556 "configure"
+#line 4607 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -4563,7 +4614,7 @@
 crypt()
 ; return 0; }
 EOF
-if { (eval echo configure:4567: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4618: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -4592,7 +4643,7 @@
 
 # Checks for data types
 echo $ac_n "checking size of char""... $ac_c" 1>&6
-echo "configure:4596: checking size of char" >&5
+echo "configure:4647: checking size of char" >&5
 if eval "test \"`echo '$''{'ac_cv_sizeof_char'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -4600,7 +4651,7 @@
   ac_cv_sizeof_char=1
 else
   cat > conftest.$ac_ext <<EOF
-#line 4604 "configure"
+#line 4655 "configure"
 #include "confdefs.h"
 #include <stdio.h>
 main()
@@ -4611,7 +4662,7 @@
   exit(0);
 }
 EOF
-if { (eval echo configure:4615: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:4666: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   ac_cv_sizeof_char=`cat conftestval`
 else
@@ -4631,7 +4682,7 @@
 
 
 echo $ac_n "checking size of short int""... $ac_c" 1>&6
-echo "configure:4635: checking size of short int" >&5
+echo "configure:4686: checking size of short int" >&5
 if eval "test \"`echo '$''{'ac_cv_sizeof_short_int'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -4639,7 +4690,7 @@
   ac_cv_sizeof_short_int=2
 else
   cat > conftest.$ac_ext <<EOF
-#line 4643 "configure"
+#line 4694 "configure"
 #include "confdefs.h"
 #include <stdio.h>
 main()
@@ -4650,7 +4701,7 @@
   exit(0);
 }
 EOF
-if { (eval echo configure:4654: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:4705: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   ac_cv_sizeof_short_int=`cat conftestval`
 else
@@ -4670,7 +4721,7 @@
 
 
 echo $ac_n "checking size of int""... $ac_c" 1>&6
-echo "configure:4674: checking size of int" >&5
+echo "configure:4725: checking size of int" >&5
 if eval "test \"`echo '$''{'ac_cv_sizeof_int'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -4678,7 +4729,7 @@
   ac_cv_sizeof_int=4
 else
   cat > conftest.$ac_ext <<EOF
-#line 4682 "configure"
+#line 4733 "configure"
 #include "confdefs.h"
 #include <stdio.h>
 main()
@@ -4689,7 +4740,7 @@
   exit(0);
 }
 EOF
-if { (eval echo configure:4693: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:4744: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   ac_cv_sizeof_int=`cat conftestval`
 else
@@ -4709,7 +4760,7 @@
 
 
 echo $ac_n "checking size of long int""... $ac_c" 1>&6
-echo "configure:4713: checking size of long int" >&5
+echo "configure:4764: checking size of long int" >&5
 if eval "test \"`echo '$''{'ac_cv_sizeof_long_int'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -4717,7 +4768,7 @@
   ac_cv_sizeof_long_int=4
 else
   cat > conftest.$ac_ext <<EOF
-#line 4721 "configure"
+#line 4772 "configure"
 #include "confdefs.h"
 #include <stdio.h>
 main()
@@ -4728,7 +4779,7 @@
   exit(0);
 }
 EOF
-if { (eval echo configure:4732: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:4783: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   ac_cv_sizeof_long_int=`cat conftestval`
 else
@@ -4748,7 +4799,7 @@
 
 
 echo $ac_n "checking size of long long int""... $ac_c" 1>&6
-echo "configure:4752: checking size of long long int" >&5
+echo "configure:4803: checking size of long long int" >&5
 if eval "test \"`echo '$''{'ac_cv_sizeof_long_long_int'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -4756,7 +4807,7 @@
   ac_cv_sizeof_long_long_int=8
 else
   cat > conftest.$ac_ext <<EOF
-#line 4760 "configure"
+#line 4811 "configure"
 #include "confdefs.h"
 #include <stdio.h>
 main()
@@ -4767,7 +4818,7 @@
   exit(0);
 }
 EOF
-if { (eval echo configure:4771: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:4822: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   ac_cv_sizeof_long_long_int=`cat conftestval`
 else
@@ -4789,20 +4840,20 @@
 
 # More checks for data types
 echo $ac_n "checking for u_int type""... $ac_c" 1>&6
-echo "configure:4793: checking for u_int type" >&5
+echo "configure:4844: checking for u_int type" >&5
 if eval "test \"`echo '$''{'ac_cv_have_u_int'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 4799 "configure"
+#line 4850 "configure"
 #include "confdefs.h"
  #include <sys/types.h> 
 int main() {
  u_int a; a = 1;
 ; return 0; }
 EOF
-if { (eval echo configure:4806: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:4857: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_u_int="yes" 
 else
@@ -4826,20 +4877,20 @@
 fi
 
 echo $ac_n "checking for intXX_t types""... $ac_c" 1>&6
-echo "configure:4830: checking for intXX_t types" >&5
+echo "configure:4881: checking for intXX_t types" >&5
 if eval "test \"`echo '$''{'ac_cv_have_intxx_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 4836 "configure"
+#line 4887 "configure"
 #include "confdefs.h"
  #include <sys/types.h> 
 int main() {
  int8_t a; int16_t b; int32_t c; a = b = c = 1;
 ; return 0; }
 EOF
-if { (eval echo configure:4843: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:4894: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_intxx_t="yes" 
 else
@@ -4863,20 +4914,20 @@
 fi
 	
 echo $ac_n "checking for int64_t type""... $ac_c" 1>&6
-echo "configure:4867: checking for int64_t type" >&5
+echo "configure:4918: checking for int64_t type" >&5
 if eval "test \"`echo '$''{'ac_cv_have_int64_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 4873 "configure"
+#line 4924 "configure"
 #include "confdefs.h"
  #include <sys/types.h> 
 int main() {
  int64_t a; a = 1;
 ; return 0; }
 EOF
-if { (eval echo configure:4880: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:4931: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_int64_t="yes" 
 else
@@ -4900,20 +4951,20 @@
 fi
 	
 echo $ac_n "checking for u_intXX_t types""... $ac_c" 1>&6
-echo "configure:4904: checking for u_intXX_t types" >&5
+echo "configure:4955: checking for u_intXX_t types" >&5
 if eval "test \"`echo '$''{'ac_cv_have_u_intxx_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 4910 "configure"
+#line 4961 "configure"
 #include "confdefs.h"
  #include <sys/types.h> 
 int main() {
  u_int8_t a; u_int16_t b; u_int32_t c; a = b = c = 1;
 ; return 0; }
 EOF
-if { (eval echo configure:4917: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:4968: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_u_intxx_t="yes" 
 else
@@ -4937,20 +4988,20 @@
 fi
 
 echo $ac_n "checking for u_int64_t types""... $ac_c" 1>&6
-echo "configure:4941: checking for u_int64_t types" >&5
+echo "configure:4992: checking for u_int64_t types" >&5
 if eval "test \"`echo '$''{'ac_cv_have_u_int64_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 4947 "configure"
+#line 4998 "configure"
 #include "confdefs.h"
  #include <sys/types.h> 
 int main() {
  u_int64_t a; a = 1;
 ; return 0; }
 EOF
-if { (eval echo configure:4954: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5005: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_u_int64_t="yes" 
 else
@@ -4977,9 +5028,9 @@
            test "x$ac_cv_header_sys_bitypes_h" = "xyes")
 then
 	echo $ac_n "checking for intXX_t and u_intXX_t types in sys/bitypes.h""... $ac_c" 1>&6
-echo "configure:4981: checking for intXX_t and u_intXX_t types in sys/bitypes.h" >&5
+echo "configure:5032: checking for intXX_t and u_intXX_t types in sys/bitypes.h" >&5
 	cat > conftest.$ac_ext <<EOF
-#line 4983 "configure"
+#line 5034 "configure"
 #include "confdefs.h"
 
 #include <sys/bitypes.h>
@@ -4992,7 +5043,7 @@
 		
 ; return 0; }
 EOF
-if { (eval echo configure:4996: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5047: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   
 			cat >> confdefs.h <<\EOF
@@ -5017,13 +5068,13 @@
 
 if test -z "$have_u_intxx_t" ; then
 	echo $ac_n "checking for uintXX_t types""... $ac_c" 1>&6
-echo "configure:5021: checking for uintXX_t types" >&5
+echo "configure:5072: checking for uintXX_t types" >&5
 if eval "test \"`echo '$''{'ac_cv_have_uintxx_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 5027 "configure"
+#line 5078 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -5032,7 +5083,7 @@
  uint8_t a; uint16_t b; uint32_t c; a = b = c = 1; 
 ; return 0; }
 EOF
-if { (eval echo configure:5036: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5087: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_uintxx_t="yes" 
 else
@@ -5056,13 +5107,13 @@
 fi
 
 echo $ac_n "checking for socklen_t""... $ac_c" 1>&6
-echo "configure:5060: checking for socklen_t" >&5
+echo "configure:5111: checking for socklen_t" >&5
 if eval "test \"`echo '$''{'ac_cv_have_socklen_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 5066 "configure"
+#line 5117 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -5072,7 +5123,7 @@
 socklen_t foo; foo = 1235;
 ; return 0; }
 EOF
-if { (eval echo configure:5076: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5127: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_socklen_t="yes" 
 else
@@ -5095,13 +5146,13 @@
 fi
 
 echo $ac_n "checking for size_t""... $ac_c" 1>&6
-echo "configure:5099: checking for size_t" >&5
+echo "configure:5150: checking for size_t" >&5
 if eval "test \"`echo '$''{'ac_cv_have_size_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 5105 "configure"
+#line 5156 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -5110,7 +5161,7 @@
  size_t foo; foo = 1235; 
 ; return 0; }
 EOF
-if { (eval echo configure:5114: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5165: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_size_t="yes" 
 else
@@ -5133,13 +5184,13 @@
 fi
 
 echo $ac_n "checking for ssize_t""... $ac_c" 1>&6
-echo "configure:5137: checking for ssize_t" >&5
+echo "configure:5188: checking for ssize_t" >&5
 if eval "test \"`echo '$''{'ac_cv_have_ssize_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 5143 "configure"
+#line 5194 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -5148,7 +5199,7 @@
  ssize_t foo; foo = 1235; 
 ; return 0; }
 EOF
-if { (eval echo configure:5152: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5203: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_ssize_t="yes" 
 else
@@ -5171,13 +5222,13 @@
 fi
 
 echo $ac_n "checking for clock_t""... $ac_c" 1>&6
-echo "configure:5175: checking for clock_t" >&5
+echo "configure:5226: checking for clock_t" >&5
 if eval "test \"`echo '$''{'ac_cv_have_clock_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 5181 "configure"
+#line 5232 "configure"
 #include "confdefs.h"
 
 #include <time.h>
@@ -5186,7 +5237,7 @@
  clock_t foo; foo = 1235; 
 ; return 0; }
 EOF
-if { (eval echo configure:5190: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5241: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_clock_t="yes" 
 else
@@ -5209,13 +5260,13 @@
 fi
 
 echo $ac_n "checking for sa_family_t""... $ac_c" 1>&6
-echo "configure:5213: checking for sa_family_t" >&5
+echo "configure:5264: checking for sa_family_t" >&5
 if eval "test \"`echo '$''{'ac_cv_have_sa_family_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 5219 "configure"
+#line 5270 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -5225,7 +5276,7 @@
  sa_family_t foo; foo = 1235; 
 ; return 0; }
 EOF
-if { (eval echo configure:5229: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5280: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_sa_family_t="yes" 
 else
@@ -5233,7 +5284,7 @@
   cat conftest.$ac_ext >&5
   rm -rf conftest*
    cat > conftest.$ac_ext <<EOF
-#line 5237 "configure"
+#line 5288 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -5244,7 +5295,7 @@
  sa_family_t foo; foo = 1235; 
 ; return 0; }
 EOF
-if { (eval echo configure:5248: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5299: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_sa_family_t="yes" 
 else
@@ -5270,13 +5321,13 @@
 fi
 
 echo $ac_n "checking for pid_t""... $ac_c" 1>&6
-echo "configure:5274: checking for pid_t" >&5
+echo "configure:5325: checking for pid_t" >&5
 if eval "test \"`echo '$''{'ac_cv_have_pid_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 5280 "configure"
+#line 5331 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -5285,7 +5336,7 @@
  pid_t foo; foo = 1235; 
 ; return 0; }
 EOF
-if { (eval echo configure:5289: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5340: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_pid_t="yes" 
 else
@@ -5308,13 +5359,13 @@
 fi
 
 echo $ac_n "checking for mode_t""... $ac_c" 1>&6
-echo "configure:5312: checking for mode_t" >&5
+echo "configure:5363: checking for mode_t" >&5
 if eval "test \"`echo '$''{'ac_cv_have_mode_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 5318 "configure"
+#line 5369 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -5323,7 +5374,7 @@
  mode_t foo; foo = 1235; 
 ; return 0; }
 EOF
-if { (eval echo configure:5327: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5378: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_mode_t="yes" 
 else
@@ -5347,13 +5398,13 @@
 
 
 echo $ac_n "checking for struct sockaddr_storage""... $ac_c" 1>&6
-echo "configure:5351: checking for struct sockaddr_storage" >&5
+echo "configure:5402: checking for struct sockaddr_storage" >&5
 if eval "test \"`echo '$''{'ac_cv_have_struct_sockaddr_storage'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 5357 "configure"
+#line 5408 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -5363,7 +5414,7 @@
  struct sockaddr_storage s; 
 ; return 0; }
 EOF
-if { (eval echo configure:5367: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5418: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_struct_sockaddr_storage="yes" 
 else
@@ -5386,13 +5437,13 @@
 fi
 
 echo $ac_n "checking for struct sockaddr_in6""... $ac_c" 1>&6
-echo "configure:5390: checking for struct sockaddr_in6" >&5
+echo "configure:5441: checking for struct sockaddr_in6" >&5
 if eval "test \"`echo '$''{'ac_cv_have_struct_sockaddr_in6'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 5396 "configure"
+#line 5447 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -5402,7 +5453,7 @@
  struct sockaddr_in6 s; s.sin6_family = 0; 
 ; return 0; }
 EOF
-if { (eval echo configure:5406: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5457: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_struct_sockaddr_in6="yes" 
 else
@@ -5425,13 +5476,13 @@
 fi
 
 echo $ac_n "checking for struct in6_addr""... $ac_c" 1>&6
-echo "configure:5429: checking for struct in6_addr" >&5
+echo "configure:5480: checking for struct in6_addr" >&5
 if eval "test \"`echo '$''{'ac_cv_have_struct_in6_addr'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 5435 "configure"
+#line 5486 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -5441,7 +5492,7 @@
  struct in6_addr s; s.s6_addr[0] = 0; 
 ; return 0; }
 EOF
-if { (eval echo configure:5445: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5496: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_struct_in6_addr="yes" 
 else
@@ -5464,13 +5515,13 @@
 fi
 
 echo $ac_n "checking for struct addrinfo""... $ac_c" 1>&6
-echo "configure:5468: checking for struct addrinfo" >&5
+echo "configure:5519: checking for struct addrinfo" >&5
 if eval "test \"`echo '$''{'ac_cv_have_struct_addrinfo'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 5474 "configure"
+#line 5525 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -5481,7 +5532,7 @@
  struct addrinfo s; s.ai_flags = AI_PASSIVE; 
 ; return 0; }
 EOF
-if { (eval echo configure:5485: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5536: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_struct_addrinfo="yes" 
 else
@@ -5504,20 +5555,20 @@
 fi
 
 echo $ac_n "checking for struct timeval""... $ac_c" 1>&6
-echo "configure:5508: checking for struct timeval" >&5
+echo "configure:5559: checking for struct timeval" >&5
 if eval "test \"`echo '$''{'ac_cv_have_struct_timeval'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 5514 "configure"
+#line 5565 "configure"
 #include "confdefs.h"
  #include <sys/time.h> 
 int main() {
  struct timeval tv; tv.tv_sec = 1;
 ; return 0; }
 EOF
-if { (eval echo configure:5521: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5572: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_struct_timeval="yes" 
 else
@@ -5551,7 +5602,7 @@
     { echo "configure: error: can not run test program while cross compiling" 1>&2; exit 1; }
 else
   cat > conftest.$ac_ext <<EOF
-#line 5555 "configure"
+#line 5606 "configure"
 #include "confdefs.h"
 
 #include <stdio.h>
@@ -5578,7 +5629,7 @@
 #endif
 		
 EOF
-if { (eval echo configure:5582: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:5633: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
    true 
 else
@@ -5602,13 +5653,13 @@
 		ossh_safe=`echo "utmp.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_host
 	echo $ac_n "checking for ut_host field in utmp.h""... $ac_c" 1>&6
-echo "configure:5606: checking for ut_host field in utmp.h" >&5
+echo "configure:5657: checking for ut_host field in utmp.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 5612 "configure"
+#line 5663 "configure"
 #include "confdefs.h"
 #include <utmp.h>
 EOF
@@ -5642,13 +5693,13 @@
 		ossh_safe=`echo "utmpx.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_host
 	echo $ac_n "checking for ut_host field in utmpx.h""... $ac_c" 1>&6
-echo "configure:5646: checking for ut_host field in utmpx.h" >&5
+echo "configure:5697: checking for ut_host field in utmpx.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 5652 "configure"
+#line 5703 "configure"
 #include "confdefs.h"
 #include <utmpx.h>
 EOF
@@ -5682,13 +5733,13 @@
 		ossh_safe=`echo "utmpx.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"syslen
 	echo $ac_n "checking for syslen field in utmpx.h""... $ac_c" 1>&6
-echo "configure:5686: checking for syslen field in utmpx.h" >&5
+echo "configure:5737: checking for syslen field in utmpx.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 5692 "configure"
+#line 5743 "configure"
 #include "confdefs.h"
 #include <utmpx.h>
 EOF
@@ -5722,13 +5773,13 @@
 		ossh_safe=`echo "utmp.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_pid
 	echo $ac_n "checking for ut_pid field in utmp.h""... $ac_c" 1>&6
-echo "configure:5726: checking for ut_pid field in utmp.h" >&5
+echo "configure:5777: checking for ut_pid field in utmp.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 5732 "configure"
+#line 5783 "configure"
 #include "confdefs.h"
 #include <utmp.h>
 EOF
@@ -5762,13 +5813,13 @@
 		ossh_safe=`echo "utmp.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_type
 	echo $ac_n "checking for ut_type field in utmp.h""... $ac_c" 1>&6
-echo "configure:5766: checking for ut_type field in utmp.h" >&5
+echo "configure:5817: checking for ut_type field in utmp.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 5772 "configure"
+#line 5823 "configure"
 #include "confdefs.h"
 #include <utmp.h>
 EOF
@@ -5802,13 +5853,13 @@
 		ossh_safe=`echo "utmpx.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_type
 	echo $ac_n "checking for ut_type field in utmpx.h""... $ac_c" 1>&6
-echo "configure:5806: checking for ut_type field in utmpx.h" >&5
+echo "configure:5857: checking for ut_type field in utmpx.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 5812 "configure"
+#line 5863 "configure"
 #include "confdefs.h"
 #include <utmpx.h>
 EOF
@@ -5842,13 +5893,13 @@
 		ossh_safe=`echo "utmp.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_tv
 	echo $ac_n "checking for ut_tv field in utmp.h""... $ac_c" 1>&6
-echo "configure:5846: checking for ut_tv field in utmp.h" >&5
+echo "configure:5897: checking for ut_tv field in utmp.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 5852 "configure"
+#line 5903 "configure"
 #include "confdefs.h"
 #include <utmp.h>
 EOF
@@ -5882,13 +5933,13 @@
 		ossh_safe=`echo "utmp.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_id
 	echo $ac_n "checking for ut_id field in utmp.h""... $ac_c" 1>&6
-echo "configure:5886: checking for ut_id field in utmp.h" >&5
+echo "configure:5937: checking for ut_id field in utmp.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 5892 "configure"
+#line 5943 "configure"
 #include "confdefs.h"
 #include <utmp.h>
 EOF
@@ -5922,13 +5973,13 @@
 		ossh_safe=`echo "utmpx.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_id
 	echo $ac_n "checking for ut_id field in utmpx.h""... $ac_c" 1>&6
-echo "configure:5926: checking for ut_id field in utmpx.h" >&5
+echo "configure:5977: checking for ut_id field in utmpx.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 5932 "configure"
+#line 5983 "configure"
 #include "confdefs.h"
 #include <utmpx.h>
 EOF
@@ -5962,13 +6013,13 @@
 		ossh_safe=`echo "utmp.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_addr
 	echo $ac_n "checking for ut_addr field in utmp.h""... $ac_c" 1>&6
-echo "configure:5966: checking for ut_addr field in utmp.h" >&5
+echo "configure:6017: checking for ut_addr field in utmp.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 5972 "configure"
+#line 6023 "configure"
 #include "confdefs.h"
 #include <utmp.h>
 EOF
@@ -6002,13 +6053,13 @@
 		ossh_safe=`echo "utmpx.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_addr
 	echo $ac_n "checking for ut_addr field in utmpx.h""... $ac_c" 1>&6
-echo "configure:6006: checking for ut_addr field in utmpx.h" >&5
+echo "configure:6057: checking for ut_addr field in utmpx.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 6012 "configure"
+#line 6063 "configure"
 #include "confdefs.h"
 #include <utmpx.h>
 EOF
@@ -6042,13 +6093,13 @@
 		ossh_safe=`echo "utmp.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_addr_v6
 	echo $ac_n "checking for ut_addr_v6 field in utmp.h""... $ac_c" 1>&6
-echo "configure:6046: checking for ut_addr_v6 field in utmp.h" >&5
+echo "configure:6097: checking for ut_addr_v6 field in utmp.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 6052 "configure"
+#line 6103 "configure"
 #include "confdefs.h"
 #include <utmp.h>
 EOF
@@ -6082,13 +6133,13 @@
 		ossh_safe=`echo "utmpx.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_addr_v6
 	echo $ac_n "checking for ut_addr_v6 field in utmpx.h""... $ac_c" 1>&6
-echo "configure:6086: checking for ut_addr_v6 field in utmpx.h" >&5
+echo "configure:6137: checking for ut_addr_v6 field in utmpx.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 6092 "configure"
+#line 6143 "configure"
 #include "confdefs.h"
 #include <utmpx.h>
 EOF
@@ -6122,13 +6173,13 @@
 		ossh_safe=`echo "utmp.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_exit
 	echo $ac_n "checking for ut_exit field in utmp.h""... $ac_c" 1>&6
-echo "configure:6126: checking for ut_exit field in utmp.h" >&5
+echo "configure:6177: checking for ut_exit field in utmp.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 6132 "configure"
+#line 6183 "configure"
 #include "confdefs.h"
 #include <utmp.h>
 EOF
@@ -6162,13 +6213,13 @@
 		ossh_safe=`echo "utmp.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_time
 	echo $ac_n "checking for ut_time field in utmp.h""... $ac_c" 1>&6
-echo "configure:6166: checking for ut_time field in utmp.h" >&5
+echo "configure:6217: checking for ut_time field in utmp.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 6172 "configure"
+#line 6223 "configure"
 #include "confdefs.h"
 #include <utmp.h>
 EOF
@@ -6202,13 +6253,13 @@
 		ossh_safe=`echo "utmpx.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_time
 	echo $ac_n "checking for ut_time field in utmpx.h""... $ac_c" 1>&6
-echo "configure:6206: checking for ut_time field in utmpx.h" >&5
+echo "configure:6257: checking for ut_time field in utmpx.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 6212 "configure"
+#line 6263 "configure"
 #include "confdefs.h"
 #include <utmpx.h>
 EOF
@@ -6242,13 +6293,13 @@
 		ossh_safe=`echo "utmpx.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_tv
 	echo $ac_n "checking for ut_tv field in utmpx.h""... $ac_c" 1>&6
-echo "configure:6246: checking for ut_tv field in utmpx.h" >&5
+echo "configure:6297: checking for ut_tv field in utmpx.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 6252 "configure"
+#line 6303 "configure"
 #include "confdefs.h"
 #include <utmpx.h>
 EOF
@@ -6278,12 +6329,12 @@
 	fi
 
 echo $ac_n "checking for st_blksize in struct stat""... $ac_c" 1>&6
-echo "configure:6282: checking for st_blksize in struct stat" >&5
+echo "configure:6333: checking for st_blksize in struct stat" >&5
 if eval "test \"`echo '$''{'ac_cv_struct_st_blksize'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 6287 "configure"
+#line 6338 "configure"
 #include "confdefs.h"
 #include <sys/types.h>
 #include <sys/stat.h>
@@ -6291,7 +6342,7 @@
 struct stat s; s.st_blksize;
 ; return 0; }
 EOF
-if { (eval echo configure:6295: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:6346: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   ac_cv_struct_st_blksize=yes
 else
@@ -6313,13 +6364,13 @@
 
 
 echo $ac_n "checking for sun_len field in struct sockaddr_un""... $ac_c" 1>&6
-echo "configure:6317: checking for sun_len field in struct sockaddr_un" >&5
+echo "configure:6368: checking for sun_len field in struct sockaddr_un" >&5
 if eval "test \"`echo '$''{'ac_cv_have_sun_len_in_struct_sockaddr_un'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 6323 "configure"
+#line 6374 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -6329,7 +6380,7 @@
  struct sockaddr_un s; s.sun_len = 1; 
 ; return 0; }
 EOF
-if { (eval echo configure:6333: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:6384: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_sun_len_in_struct_sockaddr_un="yes" 
 else
@@ -6351,13 +6402,13 @@
 fi
 
 echo $ac_n "checking for ss_family field in struct sockaddr_storage""... $ac_c" 1>&6
-echo "configure:6355: checking for ss_family field in struct sockaddr_storage" >&5
+echo "configure:6406: checking for ss_family field in struct sockaddr_storage" >&5
 if eval "test \"`echo '$''{'ac_cv_have_ss_family_in_struct_ss'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 6361 "configure"
+#line 6412 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -6367,7 +6418,7 @@
  struct sockaddr_storage s; s.ss_family = 1; 
 ; return 0; }
 EOF
-if { (eval echo configure:6371: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:6422: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_ss_family_in_struct_ss="yes" 
 else
@@ -6389,13 +6440,13 @@
 fi
 
 echo $ac_n "checking for __ss_family field in struct sockaddr_storage""... $ac_c" 1>&6
-echo "configure:6393: checking for __ss_family field in struct sockaddr_storage" >&5
+echo "configure:6444: checking for __ss_family field in struct sockaddr_storage" >&5
 if eval "test \"`echo '$''{'ac_cv_have___ss_family_in_struct_ss'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 6399 "configure"
+#line 6450 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -6405,7 +6456,7 @@
  struct sockaddr_storage s; s.__ss_family = 1; 
 ; return 0; }
 EOF
-if { (eval echo configure:6409: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:6460: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have___ss_family_in_struct_ss="yes" 
 else
@@ -6428,13 +6479,13 @@
 fi
 
 echo $ac_n "checking for pw_class field in struct passwd""... $ac_c" 1>&6
-echo "configure:6432: checking for pw_class field in struct passwd" >&5
+echo "configure:6483: checking for pw_class field in struct passwd" >&5
 if eval "test \"`echo '$''{'ac_cv_have_pw_class_in_struct_passwd'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 6438 "configure"
+#line 6489 "configure"
 #include "confdefs.h"
 
 #include <pwd.h>
@@ -6443,7 +6494,7 @@
  struct passwd p; p.pw_class = 0; 
 ; return 0; }
 EOF
-if { (eval echo configure:6447: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:6498: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_pw_class_in_struct_passwd="yes" 
 else
@@ -6467,20 +6518,20 @@
 
 
 echo $ac_n "checking if libc defines __progname""... $ac_c" 1>&6
-echo "configure:6471: checking if libc defines __progname" >&5
+echo "configure:6522: checking if libc defines __progname" >&5
 if eval "test \"`echo '$''{'ac_cv_libc_defines___progname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 6477 "configure"
+#line 6528 "configure"
 #include "confdefs.h"
 
 int main() {
  extern char *__progname; printf("%s", __progname); 
 ; return 0; }
 EOF
-if { (eval echo configure:6484: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:6535: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
    ac_cv_libc_defines___progname="yes" 
 else
@@ -6504,20 +6555,20 @@
 
 
 echo $ac_n "checking if libc defines sys_errlist""... $ac_c" 1>&6
-echo "configure:6508: checking if libc defines sys_errlist" >&5
+echo "configure:6559: checking if libc defines sys_errlist" >&5
 if eval "test \"`echo '$''{'ac_cv_libc_defines_sys_errlist'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 6514 "configure"
+#line 6565 "configure"
 #include "confdefs.h"
 
 int main() {
  extern const char *const sys_errlist[]; printf("%s", sys_errlist[0]);
 ; return 0; }
 EOF
-if { (eval echo configure:6521: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:6572: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
    ac_cv_libc_defines_sys_errlist="yes" 
 else
@@ -6541,20 +6592,20 @@
 
 
 echo $ac_n "checking if libc defines sys_nerr""... $ac_c" 1>&6
-echo "configure:6545: checking if libc defines sys_nerr" >&5
+echo "configure:6596: checking if libc defines sys_nerr" >&5
 if eval "test \"`echo '$''{'ac_cv_libc_defines_sys_nerr'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 6551 "configure"
+#line 6602 "configure"
 #include "confdefs.h"
 
 int main() {
  extern int sys_nerr; printf("%i", sys_nerr);
 ; return 0; }
 EOF
-if { (eval echo configure:6558: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:6609: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
    ac_cv_libc_defines_sys_nerr="yes" 
 else
@@ -6604,17 +6655,17 @@
 do
 ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
-echo "configure:6608: checking for $ac_hdr" >&5
+echo "configure:6659: checking for $ac_hdr" >&5
 if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 6613 "configure"
+#line 6664 "configure"
 #include "confdefs.h"
 #include <$ac_hdr>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:6618: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:6669: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
 ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -6644,7 +6695,7 @@
 				echo "configure: warning: Cannot find krb.h, build may fail" 1>&2
 			fi
 			echo $ac_n "checking for main in -lkrb""... $ac_c" 1>&6
-echo "configure:6648: checking for main in -lkrb" >&5
+echo "configure:6699: checking for main in -lkrb" >&5
 ac_lib_var=`echo krb'_'main | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -6652,14 +6703,14 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lkrb  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 6656 "configure"
+#line 6707 "configure"
 #include "confdefs.h"
 
 int main() {
 main()
 ; return 0; }
 EOF
-if { (eval echo configure:6663: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:6714: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -6688,7 +6739,7 @@
 
 			if test "$ac_cv_lib_krb_main" != yes; then
 				echo $ac_n "checking for main in -lkrb4""... $ac_c" 1>&6
-echo "configure:6692: checking for main in -lkrb4" >&5
+echo "configure:6743: checking for main in -lkrb4" >&5
 ac_lib_var=`echo krb4'_'main | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -6696,14 +6747,14 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lkrb4  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 6700 "configure"
+#line 6751 "configure"
 #include "confdefs.h"
 
 int main() {
 main()
 ; return 0; }
 EOF
-if { (eval echo configure:6707: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:6758: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -6739,7 +6790,7 @@
 				KLIBS="-lkrb"
 			fi
 			echo $ac_n "checking for des_cbc_encrypt in -ldes""... $ac_c" 1>&6
-echo "configure:6743: checking for des_cbc_encrypt in -ldes" >&5
+echo "configure:6794: checking for des_cbc_encrypt in -ldes" >&5
 ac_lib_var=`echo des'_'des_cbc_encrypt | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -6747,7 +6798,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-ldes  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 6751 "configure"
+#line 6802 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -6758,7 +6809,7 @@
 des_cbc_encrypt()
 ; return 0; }
 EOF
-if { (eval echo configure:6762: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:6813: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -6787,7 +6838,7 @@
 
 			if test "$ac_cv_lib_des_des_cbc_encrypt" != yes; then
 				echo $ac_n "checking for des_cbc_encrypt in -ldes425""... $ac_c" 1>&6
-echo "configure:6791: checking for des_cbc_encrypt in -ldes425" >&5
+echo "configure:6842: checking for des_cbc_encrypt in -ldes425" >&5
 ac_lib_var=`echo des425'_'des_cbc_encrypt | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -6795,7 +6846,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-ldes425  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 6799 "configure"
+#line 6850 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -6806,7 +6857,7 @@
 des_cbc_encrypt()
 ; return 0; }
 EOF
-if { (eval echo configure:6810: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:6861: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -6842,7 +6893,7 @@
 				KLIBS="-ldes"
 			fi
 			echo $ac_n "checking for dn_expand in -lresolv""... $ac_c" 1>&6
-echo "configure:6846: checking for dn_expand in -lresolv" >&5
+echo "configure:6897: checking for dn_expand in -lresolv" >&5
 ac_lib_var=`echo resolv'_'dn_expand | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -6850,7 +6901,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lresolv  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 6854 "configure"
+#line 6905 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -6861,7 +6912,7 @@
 dn_expand()
 ; return 0; }
 EOF
-if { (eval echo configure:6865: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:6916: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -6947,7 +6998,7 @@
 		# Extract the first word of "rsh", so it can be a program name with args.
 set dummy rsh; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:6951: checking for $ac_word" >&5
+echo "configure:7002: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_rsh_path'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -6997,7 +7048,7 @@
 		# Extract the first word of "xauth", so it can be a program name with args.
 set dummy xauth; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7001: checking for $ac_word" >&5
+echo "configure:7052: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_xauth_path'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7068,7 +7119,7 @@
 	
 ac_safe=`echo ""/dev/ptmx"" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for "/dev/ptmx"""... $ac_c" 1>&6
-echo "configure:7072: checking for "/dev/ptmx"" >&5
+echo "configure:7123: checking for "/dev/ptmx"" >&5
 if eval "test \"`echo '$''{'ac_cv_file_$ac_safe'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7101,7 +7152,7 @@
 
 ac_safe=`echo ""/dev/ptc"" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for "/dev/ptc"""... $ac_c" 1>&6
-echo "configure:7105: checking for "/dev/ptc"" >&5
+echo "configure:7156: checking for "/dev/ptc"" >&5
 if eval "test \"`echo '$''{'ac_cv_file_$ac_safe'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7152,7 +7203,7 @@
 		
 ac_safe=`echo ""/dev/urandom"" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for "/dev/urandom"""... $ac_c" 1>&6
-echo "configure:7156: checking for "/dev/urandom"" >&5
+echo "configure:7207: checking for "/dev/urandom"" >&5
 if eval "test \"`echo '$''{'ac_cv_file_$ac_safe'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7222,7 +7273,7 @@
 		# Check for existing socket only if we don't have a random device already
 		if test -z "$RANDOM_POOL" ; then
 			echo $ac_n "checking for PRNGD/EGD socket""... $ac_c" 1>&6
-echo "configure:7226: checking for PRNGD/EGD socket" >&5
+echo "configure:7277: checking for PRNGD/EGD socket" >&5
 			# Insert other locations here
 			for sock in /var/run/egd-pool /dev/egd-pool /etc/entropy; do
 				if test -r $sock && $TEST_MINUS_S_SH -c "test -S $sock -o -p $sock" ; then
@@ -7255,7 +7306,7 @@
 	# Extract the first word of "ls", so it can be a program name with args.
 set dummy ls; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7259: checking for $ac_word" >&5
+echo "configure:7310: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_LS'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7296,7 +7347,7 @@
 	# Extract the first word of "netstat", so it can be a program name with args.
 set dummy netstat; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7300: checking for $ac_word" >&5
+echo "configure:7351: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_NETSTAT'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7337,7 +7388,7 @@
 	# Extract the first word of "arp", so it can be a program name with args.
 set dummy arp; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7341: checking for $ac_word" >&5
+echo "configure:7392: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_ARP'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7378,7 +7429,7 @@
 	# Extract the first word of "ifconfig", so it can be a program name with args.
 set dummy ifconfig; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7382: checking for $ac_word" >&5
+echo "configure:7433: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_IFCONFIG'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7419,7 +7470,7 @@
 	# Extract the first word of "ps", so it can be a program name with args.
 set dummy ps; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7423: checking for $ac_word" >&5
+echo "configure:7474: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_PS'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7460,7 +7511,7 @@
 	# Extract the first word of "w", so it can be a program name with args.
 set dummy w; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7464: checking for $ac_word" >&5
+echo "configure:7515: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_W'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7501,7 +7552,7 @@
 	# Extract the first word of "who", so it can be a program name with args.
 set dummy who; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7505: checking for $ac_word" >&5
+echo "configure:7556: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_WHO'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7542,7 +7593,7 @@
 	# Extract the first word of "last", so it can be a program name with args.
 set dummy last; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7546: checking for $ac_word" >&5
+echo "configure:7597: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_LAST'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7583,7 +7634,7 @@
 	# Extract the first word of "lastlog", so it can be a program name with args.
 set dummy lastlog; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7587: checking for $ac_word" >&5
+echo "configure:7638: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_LASTLOG'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7624,7 +7675,7 @@
 	# Extract the first word of "df", so it can be a program name with args.
 set dummy df; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7628: checking for $ac_word" >&5
+echo "configure:7679: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_DF'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7665,7 +7716,7 @@
 	# Extract the first word of "vmstat", so it can be a program name with args.
 set dummy vmstat; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7669: checking for $ac_word" >&5
+echo "configure:7720: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_VMSTAT'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7706,7 +7757,7 @@
 	# Extract the first word of "uptime", so it can be a program name with args.
 set dummy uptime; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7710: checking for $ac_word" >&5
+echo "configure:7761: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_UPTIME'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7747,7 +7798,7 @@
 	# Extract the first word of "ipcs", so it can be a program name with args.
 set dummy ipcs; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7751: checking for $ac_word" >&5
+echo "configure:7802: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_IPCS'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7788,7 +7839,7 @@
 	# Extract the first word of "tail", so it can be a program name with args.
 set dummy tail; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7792: checking for $ac_word" >&5
+echo "configure:7843: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_TAIL'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7853,7 +7904,7 @@
 # Extract the first word of "$ac_prog", so it can be a program name with args.
 set dummy $ac_prog; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7857: checking for $ac_word" >&5
+echo "configure:7908: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_NROFF'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7942,9 +7993,9 @@
 
 if test -z "$disable_shadow" ; then
 	echo $ac_n "checking if the systems has expire shadow information""... $ac_c" 1>&6
-echo "configure:7946: checking if the systems has expire shadow information" >&5
+echo "configure:7997: checking if the systems has expire shadow information" >&5
 	cat > conftest.$ac_ext <<EOF
-#line 7948 "configure"
+#line 7999 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -7955,7 +8006,7 @@
  sp.sp_expire = sp.sp_lstchg = sp.sp_inact = 0; 
 ; return 0; }
 EOF
-if { (eval echo configure:7959: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:8010: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    sp_expire_available=yes 
 else
@@ -8022,7 +8073,7 @@
 	
 else
   cat > conftest.$ac_ext <<EOF
-#line 8026 "configure"
+#line 8077 "configure"
 #include "confdefs.h"
 
 /* find out what STDPATH is */
@@ -8054,7 +8105,7 @@
 }
 		
 EOF
-if { (eval echo configure:8058: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:8109: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
    user_path=`cat conftest.stdpath` 
 else
@@ -8111,7 +8162,7 @@
 
 
 echo $ac_n "checking if we need to convert IPv4 in IPv6-mapped addresses""... $ac_c" 1>&6
-echo "configure:8115: checking if we need to convert IPv4 in IPv6-mapped addresses" >&5
+echo "configure:8166: checking if we need to convert IPv4 in IPv6-mapped addresses" >&5
 IPV4_IN6_HACK_MSG="no" 
 # Check whether --with-4in6 or --without-4in6 was given.
 if test "${with_4in6+set}" = set; then
@@ -8163,7 +8214,7 @@
 
 
 echo $ac_n "checking whether to install ssh as suid root""... $ac_c" 1>&6
-echo "configure:8167: checking whether to install ssh as suid root" >&5
+echo "configure:8218: checking whether to install ssh as suid root" >&5
 # Check whether --enable-suid-ssh or --disable-suid-ssh was given.
 if test "${enable_suid_ssh+set}" = set; then
   enableval="$enable_suid_ssh"
@@ -8312,9 +8363,9 @@
 
 
 echo $ac_n "checking if your system defines LASTLOG_FILE""... $ac_c" 1>&6
-echo "configure:8316: checking if your system defines LASTLOG_FILE" >&5
+echo "configure:8367: checking if your system defines LASTLOG_FILE" >&5
 cat > conftest.$ac_ext <<EOF
-#line 8318 "configure"
+#line 8369 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -8330,7 +8381,7 @@
  char *lastlog = LASTLOG_FILE; 
 ; return 0; }
 EOF
-if { (eval echo configure:8334: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:8385: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    echo "$ac_t""yes" 1>&6 
 else
@@ -8340,9 +8391,9 @@
   
 		echo "$ac_t""no" 1>&6
 		echo $ac_n "checking if your system defines _PATH_LASTLOG""... $ac_c" 1>&6
-echo "configure:8344: checking if your system defines _PATH_LASTLOG" >&5
+echo "configure:8395: checking if your system defines _PATH_LASTLOG" >&5
 		cat > conftest.$ac_ext <<EOF
-#line 8346 "configure"
+#line 8397 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -8358,7 +8409,7 @@
  char *lastlog = _PATH_LASTLOG; 
 ; return 0; }
 EOF
-if { (eval echo configure:8362: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:8413: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    echo "$ac_t""yes" 1>&6 
 else
@@ -8397,9 +8448,9 @@
 fi	
 
 echo $ac_n "checking if your system defines UTMP_FILE""... $ac_c" 1>&6
-echo "configure:8401: checking if your system defines UTMP_FILE" >&5
+echo "configure:8452: checking if your system defines UTMP_FILE" >&5
 cat > conftest.$ac_ext <<EOF
-#line 8403 "configure"
+#line 8454 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -8412,7 +8463,7 @@
  char *utmp = UTMP_FILE; 
 ; return 0; }
 EOF
-if { (eval echo configure:8416: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:8467: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    echo "$ac_t""yes" 1>&6 
 else
@@ -8447,9 +8498,9 @@
 fi	
 
 echo $ac_n "checking if your system defines WTMP_FILE""... $ac_c" 1>&6
-echo "configure:8451: checking if your system defines WTMP_FILE" >&5
+echo "configure:8502: checking if your system defines WTMP_FILE" >&5
 cat > conftest.$ac_ext <<EOF
-#line 8453 "configure"
+#line 8504 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -8462,7 +8513,7 @@
  char *wtmp = WTMP_FILE; 
 ; return 0; }
 EOF
-if { (eval echo configure:8466: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:8517: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    echo "$ac_t""yes" 1>&6 
 else
@@ -8498,9 +8549,9 @@
 
 
 echo $ac_n "checking if your system defines UTMPX_FILE""... $ac_c" 1>&6
-echo "configure:8502: checking if your system defines UTMPX_FILE" >&5
+echo "configure:8553: checking if your system defines UTMPX_FILE" >&5
 cat > conftest.$ac_ext <<EOF
-#line 8504 "configure"
+#line 8555 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -8516,7 +8567,7 @@
  char *utmpx = UTMPX_FILE; 
 ; return 0; }
 EOF
-if { (eval echo configure:8520: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:8571: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    echo "$ac_t""yes" 1>&6 
 else
@@ -8543,9 +8594,9 @@
 fi	
 
 echo $ac_n "checking if your system defines WTMPX_FILE""... $ac_c" 1>&6
-echo "configure:8547: checking if your system defines WTMPX_FILE" >&5
+echo "configure:8598: checking if your system defines WTMPX_FILE" >&5
 cat > conftest.$ac_ext <<EOF
-#line 8549 "configure"
+#line 8600 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -8561,7 +8612,7 @@
  char *wtmpx = WTMPX_FILE; 
 ; return 0; }
 EOF
-if { (eval echo configure:8565: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:8616: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    echo "$ac_t""yes" 1>&6 
 else
@@ -8613,12 +8664,12 @@
 fi
 
 echo $ac_n "checking for Cygwin environment""... $ac_c" 1>&6
-echo "configure:8617: checking for Cygwin environment" >&5
+echo "configure:8668: checking for Cygwin environment" >&5
 if eval "test \"`echo '$''{'ac_cv_cygwin'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 8622 "configure"
+#line 8673 "configure"
 #include "confdefs.h"
 
 int main() {
@@ -8629,7 +8680,7 @@
 return __CYGWIN__;
 ; return 0; }
 EOF
-if { (eval echo configure:8633: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:8684: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   ac_cv_cygwin=yes
 else
@@ -8646,19 +8697,19 @@
 CYGWIN=
 test "$ac_cv_cygwin" = yes && CYGWIN=yes
 echo $ac_n "checking for mingw32 environment""... $ac_c" 1>&6
-echo "configure:8650: checking for mingw32 environment" >&5
+echo "configure:8701: checking for mingw32 environment" >&5
 if eval "test \"`echo '$''{'ac_cv_mingw32'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 8655 "configure"
+#line 8706 "configure"
 #include "confdefs.h"
 
 int main() {
 return __MINGW32__;
 ; return 0; }
 EOF
-if { (eval echo configure:8662: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:8713: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   ac_cv_mingw32=yes
 else
@@ -8677,7 +8728,7 @@
 
 
 echo $ac_n "checking for executable suffix""... $ac_c" 1>&6
-echo "configure:8681: checking for executable suffix" >&5
+echo "configure:8732: checking for executable suffix" >&5
 if eval "test \"`echo '$''{'ac_cv_exeext'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -8687,7 +8738,7 @@
   rm -f conftest*
   echo 'int main () { return 0; }' > conftest.$ac_ext
   ac_cv_exeext=
-  if { (eval echo configure:8691: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; }; then
+  if { (eval echo configure:8742: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; }; then
     for file in conftest.*; do
       case $file in
       *.c | *.o | *.obj) ;;
@@ -9146,6 +9197,7 @@
 echo "            KerberosIV support: $KRB4_MSG"
 echo "                   AFS support: $AFS_MSG"
 echo "                 S/KEY support: $SKEY_MSG"
+echo "               SecurID support: $SECURID_MSG"
 echo "          TCP Wrappers support: $TCPW_MSG"
 echo "          MD5 password support: $MD5_MSG"
 echo "   IP address in \$DISPLAY hack: $DISPLAY_HACK_MSG"
diff -ruN openssh-2.9p1-orig/configure.in openssh-2.9p1/configure.in
--- openssh-2.9p1-orig/configure.in	Thu Apr 26 14:40:28 2001
+++ openssh-2.9p1/configure.in	Sun Apr 29 22:00:00 2001
@@ -417,6 +417,35 @@
 		fi
 	]
 )
+SECURID_MSG="no"
+AC_ARG_WITH(securid,
+	[  --with-securid          Enable SecurID support],
+	[
+		if test "x$withval" != "xno" ; then
+			saved_LIBS="$LIBS"
+			LIBS="$LIBS sdiclient.a"
+			AC_MSG_CHECKING(for sdiclient.a)
+			AC_TRY_LINK(
+				[
+#include "sdi_athd.h"
+#include "sdconf.h"
+#include "sdacmvls.h"
+					struct SD_CLIENT sd_dat, *sd;
+					union config_record configure;
+				],
+				[sd = &sd_dat; creadcfg(); sd_init(sd);],
+				[
+					AC_MSG_RESULT(yes)
+					AC_DEFINE(SECURID)
+					SECURID_MSG="yes" 
+				],
+				[
+					AC_MSG_ERROR([*** sdiclient.a missing])
+				]
+			)
+		fi
+	]
+)
 
 # Check whether user wants TCP wrappers support
 TCPW_MSG="no" 
@@ -1923,6 +1952,7 @@
 echo "            KerberosIV support: $KRB4_MSG"
 echo "                   AFS support: $AFS_MSG"
 echo "                 S/KEY support: $SKEY_MSG"
+echo "               SecurID support: $SECURID_MSG"
 echo "          TCP Wrappers support: $TCPW_MSG"
 echo "          MD5 password support: $MD5_MSG"
 echo "   IP address in \$DISPLAY hack: $DISPLAY_HACK_MSG"
diff -ruN openssh-2.9p1-orig/readconf.c openssh-2.9p1/readconf.c
--- openssh-2.9p1-orig/readconf.c	Wed Apr 18 04:11:37 2001
+++ openssh-2.9p1/readconf.c	Sun Apr 29 22:00:00 2001
@@ -95,6 +95,8 @@
 	oBadOption,
 	oForwardAgent, oForwardX11, oGatewayPorts, oRhostsAuthentication,
 	oPasswordAuthentication, oRSAAuthentication, oFallBackToRsh, oUseRsh,
+	oSecurIDAuthentication, oSecurIDFallBack,
+	oAllowNonSecurID, oSecurIDUsersFile, oSecurIDIgnoreShell,
 	oChallengeResponseAuthentication, oXAuthLocation,
 #ifdef KRB4
 	oKerberosAuthentication,
@@ -126,6 +128,11 @@
 	{ "gatewayports", oGatewayPorts },
 	{ "useprivilegedport", oUsePrivilegedPort },
 	{ "rhostsauthentication", oRhostsAuthentication },
+	{ "securidauthentication", oSecurIDAuthentication },
+	{ "securidfallback", oSecurIDFallBack },
+	{ "allownonsecurid", oAllowNonSecurID },
+	{ "securidusersfile", oSecurIDUsersFile },
+	{ "securidignoreshell", oSecurIDIgnoreShell },
 	{ "passwordauthentication", oPasswordAuthentication },
 	{ "kbdinteractiveauthentication", oKbdInteractiveAuthentication },
 	{ "kbdinteractivedevices", oKbdInteractiveDevices },
@@ -322,6 +329,21 @@
 	case oRSAAuthentication:
 		intptr = &options->rsa_authentication;
 		goto parse_flag;
+	case oSecurIDAuthentication:
+		intptr = &options->securid_authentication;
+		goto parse_flag;
+	case oSecurIDFallBack:
+		intptr = &options->securid_fallback;
+		goto parse_flag;
+	case oAllowNonSecurID:
+		intptr = &options->allow_nonsecurid;
+		goto parse_flag;
+	case oSecurIDUsersFile:
+		charptr=&options->securid_usersfile;
+		goto parse_string;
+	case oSecurIDIgnoreShell:
+		intptr = &options->securid_ignore_shell;
+		goto parse_flag;
 
 	case oRhostsRSAAuthentication:
 		intptr = &options->rhosts_rsa_authentication;
@@ -719,6 +741,11 @@
 	options->rsa_authentication = -1;
 	options->pubkey_authentication = -1;
 	options->challenge_reponse_authentication = -1;
+	options->securid_authentication = -1;
+	options->securid_fallback = -1;
+	options->allow_nonsecurid = -1;
+	options->securid_usersfile = NULL;
+	options->securid_ignore_shell = -1;
 #ifdef KRB4
 	options->kerberos_authentication = -1;
 #endif
@@ -773,6 +800,14 @@
 {
 	int len;
 
+	if (options->securid_authentication == -1)
+		options->securid_authentication = 1;
+	if (options->securid_fallback == -1)
+		options->securid_fallback = 0;
+	if (options->allow_nonsecurid == -1)
+		options->allow_nonsecurid = 1;
+	if (options->securid_ignore_shell == -1)
+		options->securid_ignore_shell = 0;
 	if (options->forward_agent == -1)
 		options->forward_agent = 0;
 	if (options->forward_x11 == -1)
diff -ruN openssh-2.9p1-orig/readconf.h openssh-2.9p1/readconf.h
--- openssh-2.9p1-orig/readconf.h	Wed Apr 18 04:11:37 2001
+++ openssh-2.9p1/readconf.h	Sun Apr 29 22:00:00 2001
@@ -40,6 +40,11 @@
 	int     pubkey_authentication;	/* Try ssh2 pubkey authentication. */
 	int     hostbased_authentication;	/* ssh2's rhosts_rsa */
 	int     challenge_reponse_authentication;
+	int     securid_authentication;	/* Try SecurID authentication. */
+	int     securid_fallback;	/* Allow fall back to normal password */
+	int     allow_nonsecurid;	/* Allow non securid users logins */
+	char   *securid_usersfile;	/* SecurID auth users in this file */
+	int	securid_ignore_shell;   /* Ignore ACE propsed shell? */
 					/* Try S/Key or TIS, authentication. */
 #ifdef KRB4
 	int     kerberos_authentication;	/* Try Kerberos
diff -ruN openssh-2.9p1-orig/servconf.c openssh-2.9p1/servconf.c
--- openssh-2.9p1-orig/servconf.c	Wed Apr 25 22:44:15 2001
+++ openssh-2.9p1/servconf.c	Sun Apr 29 22:00:00 2001
@@ -70,6 +70,13 @@
 	options->hostbased_uses_name_from_packet_only = -1;
 	options->rsa_authentication = -1;
 	options->pubkey_authentication = -1;
+#ifdef SECURID
+	options->securid_authentication = -1;
+	options->securid_fallback = -1;
+	options->allow_nonsecurid = -1;
+	options->securid_usersfile = NULL;
+	options->securid_ignore_shell = -1;
+#endif
 #ifdef KRB4
 	options->kerberos_authentication = -1;
 	options->kerberos_or_local_passwd = -1;
@@ -168,6 +175,16 @@
 		options->rsa_authentication = 1;
 	if (options->pubkey_authentication == -1)
 		options->pubkey_authentication = 1;
+#ifdef SECURID
+	if (options->securid_authentication == -1)
+		options->securid_authentication = 1;
+	if (options->securid_fallback == -1)
+		options->securid_fallback = 0;
+	if (options->allow_nonsecurid == -1)
+		options->securid_fallback = 1;
+	if (options->securid_ignore_shell == -1)
+		options->securid_ignore_shell = 0;
+#endif
 #ifdef KRB4
 	if (options->kerberos_authentication == -1)
 		options->kerberos_authentication = (access(KEYFILE, R_OK) == 0);
@@ -218,6 +235,10 @@
 	sPort, sHostKeyFile, sServerKeyBits, sLoginGraceTime, sKeyRegenerationTime,
 	sPermitRootLogin, sLogFacility, sLogLevel,
 	sRhostsAuthentication, sRhostsRSAAuthentication, sRSAAuthentication,
+#ifdef SECURID
+	sSecurIDAuthentication, sSecurIDFallBack, sAllowNonSecurID,
+	sSecurIDUsersFile, sSecurIDIgnoreShell,
+#endif
 #ifdef KRB4
 	sKerberosAuthentication, sKerberosOrLocalPasswd, sKerberosTicketCleanup,
 #endif
@@ -252,6 +273,13 @@
 	{ "keyregenerationinterval", sKeyRegenerationTime },
 	{ "permitrootlogin", sPermitRootLogin },
 	{ "syslogfacility", sLogFacility },
+#ifdef SECURID
+	{ "securidauthentication", sSecurIDAuthentication },
+	{ "securidfallback", sSecurIDFallBack },
+	{ "allownonsecurid", sAllowNonSecurID },
+	{ "securidusersfile", sSecurIDUsersFile },
+	{ "securidignoreshell", sSecurIDIgnoreShell },
+#endif
 	{ "loglevel", sLogLevel },
 	{ "rhostsauthentication", sRhostsAuthentication },
 	{ "rhostsrsaauthentication", sRhostsRSAAuthentication },
@@ -577,6 +605,23 @@
 
 		case sKerberosTicketCleanup:
 			intptr = &options->kerberos_ticket_cleanup;
+			goto parse_flag;
+#endif
+#ifdef SECURID
+		case sSecurIDAuthentication:
+			intptr = &options->securid_authentication;
+			goto parse_flag;
+		case sSecurIDFallBack:
+			intptr = &options->securid_fallback;
+			goto parse_flag;
+		case sAllowNonSecurID:
+			intptr = &options->allow_nonsecurid;
+			goto parse_flag;
+		case sSecurIDUsersFile:
+			charptr = &options->securid_usersfile;
+			goto parse_filename;
+		case sSecurIDIgnoreShell:
+			intptr = &options->securid_ignore_shell;
 			goto parse_flag;
 #endif
 
diff -ruN openssh-2.9p1-orig/servconf.h openssh-2.9p1/servconf.h
--- openssh-2.9p1-orig/servconf.h	Wed Apr 25 22:44:16 2001
+++ openssh-2.9p1/servconf.h	Sun Apr 29 22:00:00 2001
@@ -84,6 +84,19 @@
 	int     kerberos_ticket_cleanup;	/* If true, destroy ticket
 						 * file on logout. */
 #endif
+#ifdef SECURID
+	int     securid_authentication; /* If set, use securid */
+	int	securid_fallback;	/* If set, allow normal passwords
+					   is master/slave are not accessible */
+	int	allow_nonsecurid;	/* If set, allow nonsecurid users
+					   logins via other means (e.g. PAM) */
+	char   *securid_usersfile;	/* If set, only users in the file
+					   will authenticate via SecurID
+					   The shell need not be .../sdshell */
+	int	securid_ignore_shell;	/* If true, use the shell in /etc/passwd
+					   instead of the shell proposed by
+					   the ACE server. */
+#endif
 #ifdef AFS
 	int     kerberos_tgt_passing;	/* If true, permit Kerberos tgt
 					 * passing. */
diff -ruN openssh-2.9p1-orig/sshd.0 openssh-2.9p1/sshd.0
--- openssh-2.9p1-orig/sshd.0	Sun Apr 29 21:49:49 2001
+++ openssh-2.9p1/sshd.0	Sun Apr 29 22:00:50 2001
@@ -186,6 +186,16 @@
              Only group names are valid; a numerical group ID isn't recogM--
              nized.  By default login is allowed regardless of the group list.
 
+     AllowNonSecurID
+             This will allow users that do not meet the SecurID login activaM--
+             tion requirements (not in the SecurIDUsersFile or do not have a
+             shell ending with sdshell, if the SecurIDUsersFile option is used
+             or is omitted, respectively) to still log in using another auM--
+             thentication method (e.g. PAM or passwd.)
+
+
+
+
      AllowTcpForwarding
              Specifies whether TCP forwarding is permitted.  The default is
              ``yes''. Note that disabling TCP forwarding does not improve seM--
@@ -315,6 +325,8 @@
              is yes, the password provided by the user will be validated
              through the Kerberos KDC.  To use this option, the server needs a
              Kerberos servtab which allows the verification of the KDC's idenM--
+
+
              tity.  Default is ``yes''.
 
      KerberosOrLocalPasswd
@@ -325,8 +337,6 @@
      KerberosTgtPassing
              Specifies whether a Kerberos TGT may be forwarded to the server.
              Default is ``no'', as this only works when the Kerberos KDC is
-
-
              actually an AFS kaserver.
 
      KerberosTicketCleanup
@@ -393,7 +403,6 @@
              lowed. This allows the use of most PAM challenge response authenM--
              tication modules, but it will allow password authentication reM--
              gardless of whether PasswordAuthentication is disabled.  The deM--
-
              fault is ``no''.
 
      PasswordAuthentication
@@ -523,8 +532,6 @@
            1.   If the login is on a tty, and no command has been specified,
                 prints last login time and /etc/motd (unless prevented in the
                 configuration file or by $HOME/.hushlogin; see the FILES secM--
-
-
                 tion).
 
            2.   If the login is on a tty, records login time.
@@ -650,6 +657,7 @@
      Each line in these files contains the following fields: hostnames, bits,
      exponent, modulus, comment.  The fields are separated by spaces.
 
+
      Hostnames is a comma-separated list of patterns ('*' and '?' act as wildM--
      cards); each pattern in turn is matched against the canonical host name
      (when authenticating a client) or against the user-supplied name (when
@@ -657,7 +665,6 @@
      cate negation: if the host name matches a negated pattern, it is not acM--
      cepted (by that line) even if it matched another pattern on the line.
 
-
      Bits, exponent, and modulus are taken directly from the RSA host key;
      they can be obtained, e.g., from /etc/ssh_host_key.pub. The optional comM--
      ment field continues to the end of the line, and is not used.
@@ -853,7 +860,6 @@
 SEE ALSO
      scp(1),  sftp(1),  sftp-server(8),  ssh(1),  ssh-add(1),  ssh-agent(1),
      ssh-keygen(1),  rlogin(1),  rsh(1)
-
 
      T. Ylonen, T. Kivinen, M. Saarinen, T. Rinne, and S. Lehtinen, SSH
      Protocol Architecture, draft-ietf-secsh-architecture-07.txt, January
diff -ruN openssh-2.9p1-orig/sshd.8 openssh-2.9p1/sshd.8
--- openssh-2.9p1-orig/sshd.8	Wed Apr 25 22:44:16 2001
+++ openssh-2.9p1/sshd.8	Sun Apr 29 22:00:00 2001
@@ -310,6 +310,13 @@
 Only group names are valid; a numerical group ID isn't recognized.
 By default login is allowed regardless of the group list.
 .Pp
+.It Cm AllowNonSecurID
+This will allow users that do not meet the SecurID login 
+activation requirements (not in the SecurIDUsersFile or do not 
+have a shell ending with sdshell, if the SecurIDUsersFile option
+is used or is omitted, respectively) to still log in using another
+authentication method (e.g. PAM or passwd.)
+.Pp
 .It Cm AllowTcpForwarding
 Specifies whether TCP forwarding is permitted.
 The default is
